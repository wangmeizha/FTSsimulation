<Document file="StarVMC/Geometry/IstdGeo/IstdGeo1.xml">
<Module name="IstdGeo1" comment=" is the the STAR IST geometry modeling in AgML"  >
  <Created date="27 November 2013"  />
  <Author name="Yaping Wang (University of Illinois at Chicago)"  />

  <CDE>
   AGECOM
   GCUNIT
  </CDE>
 
<!--
    November 3 2014 Flemming
    Changed the IBMO to PCON to avoi the small overlap with an MSC ring.
 November 1, 2014, Flemming
   In view of the several overlap overlap I decided to rewrite the master volumens and positioning of
   the IBAM. With this lastest change the use tubs for the IBAM and having no extrusions I think in fact the master IBMO 
  can be removed. We will see. It need a review since there are many changes
  The IBAM was made a TUBS shape and position exclusively out side the MCS. A routine to calculate peoprer rotation
  was introduced. 
  The stepping through the IST is now done quite properly

 December 14, 2013 Flemming
  1)There is no need for the ICCM volume. The cables, cooling in questions are
  directly in IDSM. 
  2) The A,B and C cables are identical. A single Volume suffices. Same comments for some of identical
     cooling volumes
  3) Final volumes should not be MANY.
  4) Placed ICLE inside ICTJ as it properly belongs.
 December 8, 2013 Yaping
 volume ICCM for cabling/cooling sets modeling is added to the IDSM volume
 1) thin cone shape volume filled with average density (copper cables, aluminium tube and cooling liquid) is added in transition area
 2) 72 cables and 24 cooling lines on PIT are added (location according to SW drawings)

 December 7, 2013 Yaping
` 1) cooling loops between two ladders and joints are added in the west side
 2) three short cables (section A/B/C) are added from t-board to transition area
 3) short cooling tube and joint are added from stave east side to transition area 

 December 6, 2013 Yaping
 several updates done according to the newsest SolidWorks drawings (IST Assy 1-10-13).
 1) stave support block (shape and dimenssions) updated
 2) t-board (shape and dimenssion) updated
 3) cooling tube embbeded in stave (length, shape) updated
 4) several parameters updates on the newest SW drawings
 All parameters are checked and are in accordance with the SW drawings

 September 5, 2013  Yaping
 update transition board dimenssions (parameters update)

 June 17, 2013 Yaping
 update the silicon sensor local coordinate (the sensor local y axis should normal to the silicon sensor surface outwards) 
 then rotate 180 degree around Z for the sensor modules (IBSS and four dead areas) when place it in IBLM  

 June 14, 2013  Flemming
 Changed name to istdgeo1 for dev14. Change IBMO mother volume to be many

 April 28, 2013 Yaping
 update the IST ladder layout in phi distribution (shift 4.85 degree in phi) 
 so that the y axis is crossing the center of overlap active sensor area of two ladders

 January 9, 2013 Yaping
 update stave geometry due to hybrid thickness changes at different position
 Hybrid volumes and carbon fiber skin volumes are updated.

 January 8, 2013 Yaping
 update material definitions
 
 December 9, 2012 Yaping
 update Endcap modules (right and left side) and a little update for the thread hole spacers
 
 November 7, 2012 Yaping
 Screws, thread holes for screw and thermal sensor to be added.

 October 20, 2012 Yaping Wang
 ladder alignment readjusted, the shift in phi distribution is corrected.

 October 5, 2012 Yaping Wang
 update silicon sensor geometry (final sensor dimensions)

 October 4, 2012 Yaping Wang
 Support ring structure included

 October 3, 2012 Yaping Wang
 Transit board and its slots added

 October 1, 2012 Yaping Wang
 Ladder materials updated and also endcaps added
 
 September 30, 2012 Yaping
 ladder support materials were implemented into the code
 
 September 27, 2012 Yaping
 New geometry layout was updated
 
 September 19, 2012, Yaping
 This version implements real sensor layou but still without support material
 
 September 18, 2012 : the rotation and shift parameters keep no change referred from Bouchet code
 This version has paramters : 3 rotations + 3 shifts to allow misalignment of a group of ladder
 These parameters add a small rotations(or shifts) to the placement of ladders . By default, these parameters are 0 ==> no misaligment
-->
    <!-- Local variables -->
    <varlist type="float"  >
        aangle,raddeg,Ladder_Thk,Ladder_Width,Ladder_Length,x, y, xp, yp, xpos,ypos,zpos,xlocal, ylocal, ModuleRadius,tubeAngle,xtubeArc,ytubeArc,ztubeArc
    </varlist>
    
    <varlist type="float"  >
        bangle,xctjpos(12),yctjpos(12)
    </varlist>

    <varlist type="float"  >
        radius_A,radius_B,radius_C,radius_T,tilt_A,tilt_B,tilt_C,tilt_T,angle_A,angle_B,angle_C,angle_T,anglePIT_A,anglePIT_B,anglePIT_C,anglePIT_T
    </varlist>

    <varlist type="int"  >
        nl,nCTJ,nCableSet,ly,nu,ne,nes,ns,nsc,num,nSeg,debug
    </varlist>
    
  <!-- Global stuffs--> 
  <Content> 
    ICCT,
 <!--  cone shape to describe cables/cooling lines in transition area-->
            ICCA,       <!-- cables on PIT -->
	    ICCL, ICLP, <!-- cooling line on PIT -->
  	    IBMO, <!-- IST mother volume for stave, west cooling loops, east short cables/cooling lines-->
            IBAM, <!-- *IST ladder mother volume-->
            ILCC, <!-- IST ladder carbon honeycomb mother volume-->
            ICCU, <!-- IST carbon honeycomb BOX volume on east side (connecter side)-->
            ICCD, <!-- IST carbon honeycomb BOX volume on west side-->
            IBCF, <!-- IST carbon foam mother volume -->
            ICFC, <!-- IST carbon foam BOX volume on east side (connecter side)-->
            ICFD, <!-- IST carbon foam BOX volume on west side-->
            ICFB, <!-- air groove box volume in IST carbon foam for cooling tube placement-->
            ICFA, <!-- air groove arc volume in IST carbon foam for cooling tube placement-->
            IBAT, <!-- IST Alunimum cooling tube mother volume-->
	    ICTC, <!-- IST Alunimum cooling tube center cylinder -->
	    ICTE, <!-- IST Alunimum cooling tube east connection cone -->
	    ICTW, <!-- IST Alunimum cooling tube west connection cone -->
            IBCW, <!-- IST cooling liquid in the alunimum tube -->      
            ILST, <!-- IST CF skin TOP layer mother volume-->
            ISTC, <!-- CF skin BOX volume on connecter side in TOP CF skin mother volume (due to hybrid thickness changes at different Z position)-->
            ISTH, <!-- CF skin BOX volume on west side in TOP CF skin mother volume (due to hybrid thickness changes at different Z position)-->      
            ILSB, <!-- IST CF skin BOTTOM layer mother volume-->
            ISBC, <!-- CF skin BOX volume on connecter side in BOTTOM CF skin mother volume (due to hybrid thickness changes at different Z position)-->
            ISBH, <!-- CF skin BOX volume on west side in BOTTOM CF skin mother volume (due to hybrid thickness changes at different Z position)-->
            IBHT, <!-- IST hybrid top layer mother volume-->
            IHTC, <!-- IST hybrid on east side in TOP hybrid mother volume (due to hybrid thickness changes at different Z position)-->
            IHTH, <!-- IST hybrid on west side in TOP hybrid mother volume (due to hybrid thickness changes at different Z position)-->
            IBHB, <!-- IST hybrid bottom layer mother volume-->
            IHBC, <!-- IST hybrid on east side in BOTTOM hybrid mother volume (due to hybrid thickness changes at different Z position)-->
            IHBH, <!-- IST hybrid on west side in BOTTOM hybrid mother volume (due to hybrid thickness changes at different Z position)-->      
            IBHC, <!-- IST hybrid north arc layer mother volume-->
            IHCA, <!-- Inner air layer in north ARC hybrid mother volume (due to hybrid thickness changes at different Z position)-->      
            IBLM, <!-- IST sensor and APV mother volume-->
            IBSS, <!-- IST active silicon volume-->
            IBTE, <!-- IST dead area top edge-->
            IBBE, <!-- IST dead area bottom edge-->
            IBLE, <!-- IST dead area left edge-->
            IBRE, <!-- IST dead area right edge-->
            IBAP, <!-- APV readout chips -->
            IECW, <!-- IST stave westside CF endcap mother volume-->
            ICWT, <!-- IST stave westside CF endcap overlap body top BOX volume -->
            ICWB, <!-- IST stave westside CF endcap overlap body bottom BOX volume -->
            IABW, <!-- IST stave westside CF endcap air groove box area for cooling tube placement-->
            IAAW, <!-- IST stave westside CF endcap air groove top arc area for cooling tube placement-->
            ITNW, <!-- thread air hole (northwest side) for transpotation protection-->
            ITSW, <!-- thread air hole (southwest side) for transpotation protection-->
            IESB, <!-- thread air hole (middle) box area for support block fixing-->
            IESA, <!-- thread air hole (middle) arc area for support block fixing-->
            IESC, <!-- thread air hole (middle) arc area for support block fixing-->
            IECE, <!-- IST stave eastside aluminum endcap mother volume-->
            ICET, <!-- IST stave eastside aluminum endcap overlap body top BOX volume -->
            ICEB, <!-- IST stave eastside aluminum endcap overlap body bottom BOX volume -->
            IABE, <!-- IST stave eastside aluminum endcap air groove box area for cooling tube placement-->
            IAAE, <!-- IST stave eastside aluminum endcap air groove top arc area for cooling tube placement-->
            ITNE, <!-- thread air hole (northeast side) for transpotation protection-->
            ITSE, <!-- thread air hole (southeast side) for transpotation protection-->
            IESE, <!-- thread air hole (middle) in eastside endcap for support block fixing-->
	    IESS, <!-- thread air hole (close to the middle hole) in east endcap -->
            IBRB, <!-- IST Transit board-->
            IRSA, <!-- IST Transit board slot A-->
            IRSB, <!-- IST Transit board slot B-->
            IRSC, <!-- IST Transit board slot C-->      
            IBSR, <!-- IST Support ring structure mother volume-->
            ISRH, <!-- IST thread hole in supprt block-->
            ISRR, <!-- IST support structure box sub-volume right(south) side-->
            ISRB, <!-- IST support structure box sub-volume bottom(top) side-->
	    IRBA, <!-- IST air tube groove in ISRB volume-->
            ISRL, <!-- IST support structure trapezoid sub-volume left(north) side-->
            ISRC, <!-- IST support structure trapezoid sub-volume connecting ISRB and ISRL volumes-->
            ISRA, <!-- IST support structure arc surface volume top(bottom) side-->
            ISRO, <!-- IST support structure top narrow box volume-->
	    IROA, <!-- IST air tube groove in ISRO volume-->
            ISRS, <!-- IST support structure small trapzoid shape at left side-->
            ISCM, <!-- IST screw mother volume-->
            ISWS, <!-- IST screw washer-->
            ISCH, <!-- IST screw hat-->
	    ISCS, <!-- IST screw cylinder stud-->
            ISCR, <!-- IST screw stud-->
            IBTS, <!-- IST thermal sensor-->
	    <!-- cooling loops and joints (west side) -->
	    IBCJ, <!-- IST cooling loop mother volume (west side)-->
	    ICJR, <!-- IST cooling loop raidus part, filled with average density of aluminium and liquid -->
	    ICJS, <!-- IST cooling loop tube part left and right -->
	    ICJA, <!-- IST cooling loop tube cone part left and right-->
	    ICJU, <!-- IST cooling loop connector left and right-->
	    ICLN, <!-- IST cooling liquid through ICJN, ICJA and ICJU volumes -->
	    <!-- short purple cables and cooling tube from T-board to transition area (east side) -->
	    ISCA, <!-- short cable A -->
	    ISCB, <!-- short cable B -->
	    ISCC, <!-- short cable C -->
	    ICLE, <!-- cooling liquid in tube -->
	    ISCT, ICTJ, ICTA, ICTB <!-- short cooling line and joint -->
  </Content>
    
    <varlist type="float" comment=" Half Width of IST ladder mother volume" >  HalfLadWdt/3.6559/</varlist>
    <varlist type="float" comment=" Half Thcikness of IST ladder mother volume" >   HalfLadThk/1.8957/</varlist>
    <varlist type="float" comment=" Half Length of IST ladder mother volume" >    HalfLadLen/40.0877/</varlist>
    <!-- carbon honeycomb -->
    <varlist type="float" comment=" Half Width of Choneycomb in Stave" > HalfCombWdt/1.800/</varlist>
    <varlist type="float" comment=" Half Thickness of Choneycomb in Stave" > HalfCombThk/0.2900/</varlist>
    <varlist type="float" comment=" Half Length of Choneycomb in Stave" > HalfCombLen/27.94/</varlist>
    <varlist type="float" comment=" Half Thickness of Choneycomb on connecter side" > HalfCombThkConnect/0.28315/</varlist>
    <varlist type="float" comment=" Half Length of connecter side Choneycomb volume" > HalfCombLenConnect/4.4125/</varlist>
    <!-- carbon foam -->
    <varlist type="float" comment=" Half Width of Carbon Foam in Stave" > HalfFoamWdt/1.250/</varlist>
    <varlist type="float" comment=" Half Thickness of Carbon Foam in Stave" > HalfFoamThk/0.2900/</varlist>
    <varlist type="float" comment=" Half Length of Carbon Foam in Stave" > HalfFoamLen/27.94/</varlist>
    <varlist type="float" comment=" Half Thickness of Carbon Foam con connecter side" > HalfFoamThkConnect/0.28315/</varlist>
    <varlist type="float" comment=" Half Length of connecter side CARBON foam volume" > HalfFoamLenConnect/4.4125/</varlist>
    <varlist type="float" comment=" Distance of Carbon Foam north edge to ladder mother volume edge" > DistFoamToLadder/1.0618/</varlist>
    <!-- cooling tube -->    
    <varlist type="float" comment=" Inner radius of Alunimum Tube in Carbon Foam" > TubeRmin/0.18225/</varlist>
    <varlist type="float" comment=" Outer radius of Alunimum Tube in Carbon Foam" > TubeRmax/0.238125/</varlist>
    <varlist type="float" comment=" Inner radius of Alunimum Tube connection cone" > TubeConeOuterRmin/0.31625/</varlist>
    <varlist type="float" comment=" Outer radius of Alunimum Tube connection cone" > TubeConeOuterRmax/0.3721/</varlist>
    <varlist type="float" comment=" Half Length of Alunimum Tube in Carbon Foam" >  HalfTubeLen/40.0877/</varlist>
    <varlist type="float" comment=" Half Length of Alunimum Tube connection cone" >  HalfTubeConeLen/0.0889/</varlist>
    <varlist type="float" comment=" Distance from Alunimum Tube center to top skin inner surface" >  DistTubeTopSkin/0.2922/</varlist>
    <!-- cooling liquid -->
    <varlist type="float" comment=" radius of cooling liquid in Alunimum Tube" > LiquidInTubeR/0.18225/</varlist>
    <varlist type="float" comment=" Half Length of cooling liquid in Alunimum Tube" > LiquidInTubeLen/40.0877/</varlist>
    <!-- carbon foam skin -->
    <varlist type="float" comment=" Half Width of carbon fiber skin" > HalfSkinWdt/3.05/</varlist>
    <varlist type="float" comment=" Half Thickness of carbon fiber skin" > HalfSkinThk/0.0075/</varlist>
    <varlist type="float" comment=" Half Length of carbon fiber skin" > HalfSkinLen/28.440/</varlist>
    <varlist type="float" comment=" Half Thickness of carbon fiber skin mother volume" > HalfThkSkinMom/0.010925/</varlist>
    <varlist type="float" comment=" Half Length of connecter side carbon fiber skin volume" > HalfLenSkinConnect/4.5725/</varlist>
    <!-- kapton hybrid -->
    <varlist type="float" comment=" Half Width of top and bottom Hybrid" > HalfHbdWdtTB/3.05/</varlist>
    <varlist type="float" comment=" Half Thickness of top and bottom Hybrid" > HalfHbdThkTB/0.008125/</varlist>
    <varlist type="float" comment=" Half Length of top and bottom Hybrid" > HalfHbdLenTB/28.440/</varlist>
    <varlist type="float" comment=" Half Thickness of top and bottom Hybrid on connecter side" > HalfHbdThkTBConnect/0.01155/</varlist>
    <varlist type="float" comment=" Half Length of top and bottom Hybrid on connecter side" > HalfHbdLenTBConnect/4.565/</varlist>
    <varlist type="float" comment=" Half Thickness of air layer in hybrid volume" > HalfThkAirInHbd/0.003425/</varlist>
    <varlist type="float" comment=" Inner radius of north half circle Hybrid" > HbdArcRmin/0.29815/</varlist>
    <varlist type="float" comment=" Outer radius of north half circle hybrid" > HbdArcRmax/0.32125/</varlist>
    <varlist type="float" comment=" Half Length of north half circle Hybrid" > HalfHbdArcLen/28.44/</varlist>
    <varlist type="float" comment=" Outer radius of air layer in north half circle hybrid" > AirInHbdArcRmax/0.305/</varlist>
    <varlist type="float" comment=" Half Length of air layer in north half circle hybrid" > AirInHbdHalfLen/23.875/</varlist>
    <!-- APV --> 
    <varlist type="float" comment=" Half Width of APV chip" > HalfAPVWdt/0.41/</varlist>
    <varlist type="float" comment=" Half Thickness of APV chip" > HalfAPVThk/0.015/</varlist>
    <varlist type="float" comment=" Half Length of APV chip" > HalfAPVLen/0.35875/</varlist>
    <varlist type="float" comment=" Gap between two APV chips" > APVGapSize/0.5375/</varlist>
    <varlist type="float" comment=" Gap between APV chip and silicon sensor" > APVSensorGapSize/0.1019/</varlist>
    <!-- silicon sensor -->
    <varlist type="float" comment=" Half Width of Sensor active area" > HalfSensorWdt/1.9008/</varlist>
    <varlist type="float" comment=" Half Thickness of Sensor active area" > HalfSensorThk/0.015/</varlist>
    <varlist type="float" comment=" Half Length of Sensor active area" > HalfSensorLen/3.765/</varlist>
    <varlist type="float" comment=" Half Width of Sensor east and west edge structure" > HalfSensorEdgeLR/0.04/</varlist>
    <varlist type="float" comment=" Half Width of Sensor south Edge Structure" > HalfSensorEdgeT/0.0364/</varlist>
    <varlist type="float" comment=" Half Width of Sensor north Edge Structure" > HalfSensorEdgeB/0.0628/</varlist>
    <varlist type="float" comment=" Gap between two Silicon Sensor Pad" > SensorGapSize/0.04/</varlist>
    <!-- HalfSenMomWdt is sum of HalfSensorWdt, HalfSensorEdgeS, HalfSensorEdgeN, half of APVSensorGapSize and HalfAPVWdt --> 
    <varlist type="float" comment=" Half Width of mother volume of Sensor and APVs" > HalfSenMomWdt/2.46095/</varlist>
    <varlist type="float" comment=" Half Thickness of mother volume of sensor and APVs" > HalfSenMomThk/0.015/</varlist>
    <varlist type="float" comment=" Half Length of mother volume of sensor and APVs" > HalfSenMomLen/3.865/</varlist>
    <!--the variable HalfSenMomLen is sum of HalfSensorLen, two times of HalfSensorEdgeEW and Half of SensorGapSize  -->
    <varlist type="float" comment=" Distance from ladder mother volume east edge to first IBLM east edge" > DistLadderToIBLM/21.3906/</varlist>
    <varlist type="float" comment=" Distance from sensor south edge to ladder south edge" > DistSensorToLadder/0.1/</varlist>
    <!-- endcap -->
    <varlist type="float" comment=" Half Width of mother volume of endcap" > HalfEndcapMomWdt/3.05/</varlist>
    <varlist type="float" comment=" Half Thickness of mother volume of endcap" > HalfEndcapMomThk/0.305/</varlist>
    <varlist type="float" comment=" Half Length of mother volume of endcap" > HalfEndcapMomLen/1.125/</varlist>
    <varlist type="float" comment=" Half Thickness of overlap area between endcap and skin or hybrid" > HalfOverlapEndcapSkinThk/0.2775/</varlist>
    <varlist type="float" comment=" Length of connection area between endcap and skin or hybrid" > ConnectEndcapSkinLen/0.6/</varlist>
    <varlist type="float" comment=" Length of overlap area between endcap and skin or hybrid" > OverlapEndcapSkinLen/0.5/</varlist>
    <!-- t-board -->
    <varlist type="float" comment=" Half Width of transit board" > HalfTBoardWdt/1.9355/</varlist>
    <varlist type="float" comment=" Half Thickness of transit board" > HalfTBoardThk/0.0823/</varlist>
    <varlist type="float" comment=" Half Length of transit board" > HalfTBoardLen/5.830/</varlist>
    <!-- useful variables -->
    <varlist type="float" comment=" Length of outside cooling tube in west direction" > OutsideTubeWestLen/10.1548/</varlist>
    <varlist type="float" comment=" Length of outside cooling tube in east direction" > OutsideTubeEastLen/9.6406/</varlist>
    <varlist type="float" comment=" Length of transit board part of outside endcap" > OutsideTBoardLen/0.874/</varlist>
    <!-- connection slots -->
    <varlist type="float" comment=" Half Width of Transit board slot" > HalfTBslotWdt/0.25/</varlist>
    <varlist type="float" comment=" Half Thickness of Transit board slot" > HalfTBslotThk/0.288075/</varlist>
    <varlist type="float" comment=" Half Length of Transit board slot" > HalfTBslotLen/1.650/</varlist>
    <varlist type="float" comment=" Gap size in x direction between each TB slot" > TBSlotGapSize/0.150/</varlist>
    <varlist type="float" comment=" Distance from slot C to foam north edge" > DistSlotCtoFoam/0.1582/</varlist>
    <varlist type="float" comment=" Length of overlap between two slots" > OverlapSlotsLen/0.4/</varlist>
    <!-- support block -->    
    <varlist type="float" comment=" Half Width of support ring structure mother volume" > HalfSRMomWdt/1.77875/</varlist>
    <varlist type="float" comment=" Half Thickness of support ring structure mother volume" > HalfSRMomThk/1.5696/</varlist>
    <varlist type="float" comment=" Half Length of support ring structure momther volume" > HalfSRMomLen/0.635/</varlist>
    <varlist type="float" comment=" Distance from support ring structure momther volume to endcap edge" > DistSRMomToECedge/0.2738/</varlist>
    <varlist type="float" comment=" Distance from support ring structure momther volume to hybrid edge" > DistSRMomToHBDedge/0.2063/</varlist>
    <varlist type="float" comment=" Inner radius of IST support ring" > ModuleInnerRadius/11.9253/</varlist>
    <!-- readout cable diameter -->
    <varlist type="float" comment=" mass weighted of readout cable diameter" > cableDiameter/0.372/</varlist>
    <!-- IST detector parameters 
	 JCW :: Reduced inner radius to 11.0 to coincide with PXMO outer radius

  <varlist type="float" comment=" Inner radius of mother volume whole detector" > IBMOInnerRadius/11.00/</varlist>   
  -->
    <varlist type="float" comment=" Inner radius of mother volume whole detector" > IBMOInnerRadius/11.84/</varlist>    
    <varlist type="float" comment=" Outer radius of mother volume whole detector" > IBMOOuterRadius/18.5/</varlist>
    <varlist type="int"   comment=" Number of ladders" > nLadder/24/</varlist>
    <varlist type="int"   comment=" Number of silicon sensor per ladder" > nUnit/6/</varlist>
    <varlist type="int"   comment=" Number of APV chips per sensor" > nAPVUnit/6/</varlist>
    <varlist type="float" comment=" Tilt angle of each ladders" > Tilt/19.1042/</varlist>
    <varlist type="float" comment=" Angle offset between 1st ladder center axis to top direction of Y axis" > angleOffset/1.1661/</varlist>

  <!-- define rotation and shift parameters for misalignment test -->
  <Structure name="PARO" comment="set of 3 paramters (offset) to misalign a ladder ">
    <var name="version" type="int" />
    <var name="DX"   type="float" comment="is the MAX shift in local X allowed, the real shift will be a fraction"/>
    <var name="DY"   type="float" comment="is the MAX shift in local Y allowed, the real shift will be a fraction"/>
    <var name="DZ"   type="float" comment="is the MAX shift in local Z allowed, the real shift will be a fraction"/>
    <var name="mult" type="float" comment="is the multiplicator factor, [0,1]*Shift"/>
    <var name="lad(24)"  type="int"/>
  </Structure>

  <Structure name="PARA" comment="set of 3 paramters (angles) to misalign a ladder ">
    <var name="version" type="int" />
    <var name="DA"   type="float" comment="is the MAX rotation dAlpha around X allowed, the real rot. will be a fraction"/>
    <var name="DB"   type="float" comment="is the MAX rotation dBeta around Y allowed, the real rot. will be a fraction"/>
    <var name="DG"   type="float" comment="is the MAX rotation dGamma around Z allowed, the real rot. will be a fraction"/>
    <var name="mult" type="float" comment="is the multiplicator factor, [0,1]*rot"/>
    <var name="lad(24)"  type="int"/>
  </Structure>
  
  <Fill name="PARO" comment="default">
   <var name="version" value="0"/>
   <var name="DX" value="0"   comment=" default : no shift "/>
   <var name="DY" value="0"   comment=" default : no shift "/>
   <var name="DZ" value="0"   comment=" default : no shift "/>
   <var name="mult" value="0" comment=" default : no shift "/>
   <var name="lad"  value="{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}" comment="1..24"/>
  </Fill>

  <Fill name="PARO" comment="shift">
   <var name="version" value="1"/>
   <var name="DX" value="0"   comment=" shift for all ladders"/>
   <var name="DY" value="0"   comment=" default = no shift "/>
   <var name="DZ" value="1"   comment=" default = no shift "/>
   <var name="mult" value="5" comment=" max is 1 cm"/>
   <var name="lad"  value="{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}" comment="1..24"/>
  </Fill>

  <Fill name="PARA" comment="default">
   <var name="version" value="0"/>
   <var name="DA" value="0"   comment=" default = no rot "/>
   <var name="DB" value="0"   comment=" default = no rot. "/>
   <var name="DG" value="0"   comment=" default = no rot. "/>
   <var name="mult" value="0" comment=" default = no rot. "/>
   <var name="lad"  value="{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}" comment="1..24"/>
  </Fill>

  <Fill name="PARA" comment="rotation gamma">
   <var name="version" value="1"/>
   <var name="DA" value="0"    comment=" no rot."/>
   <var name="DB" value="0"    comment=" no rot. "/>
   <var name="DG" value="1"    comment=" rot. for all ladders "/>
   <var name="mult" value="1" comment=" max is 1 degrees "/>
   <var name="lad"  value="{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}" comment="1..24"/>
  </Fill>
    
  <!-- the next 2 structures are used for misalignment : offset + rotation -->
  <Use struct="PARO" select="version" value="0" />
  <Use struct="PARA" select="version" value="0" />

  <!-- structure to save west side cooling loop x/y position [cm], numbering is the same direction as ladder 1...12 -->
  xctjpos(1)= 1.4941
  xctjpos(2)= 8.7384
  xctjpos(3)=13.6413 
  xctjpos(4)=14.8890
  xctjpos(5)=12.1472
  xctjpos(6)= 6.1506
  xctjpos(7)=-1.4941
  xctjpos(8)=-8.7384
  xctjpos(9)=-13.6413
  xctjpos(10)=-14.889
  xctjpos(11)=-12.1472  
  xctjpos(12)=-6.1506
  yctjpos(1)= 14.8890
  yctjpos(2)= 12.1472
  yctjpos(3)= 6.1506
  yctjpos(4)= -1.4941
  yctjpos(5)= -8.7384
  yctjpos(6)= -13.6413
  yctjpos(7)= -14.8890
  yctjpos(8)= -12.1472
  yctjpos(9)= -6.1506
  yctjpos(10)= 1.4941
  yctjpos(11)= 8.7384
  yctjpos(12)= 13.6413

  <!-- define materials/mixtures -->
  <Material a="12" z="6" name="CARBONFOAM" dens="0.09" radl="42.7"/>  <!-- graphite for carbon foam -->
    
  <Mixture name="CFRPMix" dens="0.03" radl="23.9" >   <!-- CFRP (58% graphite and 42% plastic C26H25ClO5) for carbon honeycomb -->
    <Component name="O"  a="16"   z="8"  w="0.074"  />
    <Component name="C"  a="12"   z="6"  w="0.870"  />
    <Component name="H"  a="1"    z="1"  w="0.023"  />
    <Component name="Cl" a="35.5" z="17" w="0.033"  />
  </Mixture>
    
  <Mixture name="CFRPMix2" dens="1.60" radl="23.9" > <!-- CFRP (58% graphite and 42% plastic C26H25ClO5) for CF skin -->
    <Component name="O"  a="16"   z="8"  w="0.074"  />
    <Component name="C"  a="12"   z="6"  w="0.870"  />
    <Component name="H"  a="1"    z="1"  w="0.023"  />
    <Component name="Cl" a="35.5" z="17" w="0.033"  />
  </Mixture>

  <Mixture name="PEEKCF30" dens="1.41" radl="25.0" >  <!-- PEEK CF 30 (30% graphite and 70% PEEK C19H12O3) for west end-cap and support block -->
    <Component name="O"  a="16"   z="8"  w="0.117"  />
    <Component name="C"  a="12"   z="6"  w="0.854"  />
    <Component name="H"  a="1"    z="1"  w="0.029"  />
  </Mixture>
        
  <Mixture name="KAPTON" dens="1.42" radl="28.6" > <!-- Kapton for hybrid -->
    <Component name="O"  a="16"   z="8"  w="0.210"  />
    <Component name="C"  a="12"   z="6"  w="0.691"  />
    <Component name="H"  a="1"    z="1"  w="0.026"  />
    <Component name="N"  a="14"   z="7"  w="0.073"  />
  </Mixture>

  <Mixture name="NOVEC7200" dens="1.44">  <!-- 3M Novec 7200 (C4F9OC2H5) for cooling liquid -->
    <Component name="O" a="16" z="8"  w="0.061" />
    <Component name="H" a="1"  z="1"  w="0.019" />
    <Component name="C" a="12" z="6"  w="0.272"  />
    <Component name="F" a="9"  z="19" w="0.648"  />
  </Mixture>
    
  <Mixture name="PEEKGF30" dens="1.49" radl="25.0" >  <!-- PEEK GF 30 (30% SiO2 and 70% PEEK C19H12O3) for screws and washers -->
    <Component name="O"  a="16"    z="8"  w="0.3*2*16/60.+0.7*3*16/288."  />
    <Component name="C"  a="12"    z="6"  w="0.7*19*12/288."  />
    <Component name="Si" a="28.08" z="14" w="0.3*1*28/60." />
    <Component name="H"  a="1"     z="1"  w="0.7*12*1/288."  />
  </Mixture>
    
  <Mixture name="G10" dens="1.7"  >  <!-- G10 (60% SiO2 and 40% C8H14O4) for transition board -->
    <Component name="Si" a="28.08" z="14" w="0.6*1*28./60." />
    <Component name="O" a="16" z="8" w="0.6*2*16./60.+0.4*4*16./174." />
    <Component name="C" a="12" z="6" w="0.4*8*12./174." />
    <Component name="H" a="1"  z="1" w="0.4*14*1./174." />
  </Mixture>

  <Mixture name="DELRIN" dens="1.2"  >  <!-- Delrin (C5H8O2) for readout connectors and spacers -->
    <Component name="O" a="16" z="8" w="2*16./100." />
    <Component name="C" a="12" z="6" w="5*12./100." />
    <Component name="H" a="1"  z="1" w="8*1./100." />
  </Mixture>
    
  <Mixture name="APVMix" dens="2.535"  > <!-- referred from FgtdGeo.xml for APV chips -->
    <Component name="Si" a="28.1" z="14" w="0.191"  />
    <Component name="O"  a="16"   z="8"  w="0.339"  />
    <Component name="C"  a="12"   z="6"  w="0.213"  />
    <Component name="H"  a="1"    z="1"  w="0.028"  />
    <Component name="Cl" a="35.5" z="17" w="0.009"  />
    <Component name="Cu" a="63.5" z="29" w="0.122" />
    <Component name="Pb" a="207"  z="82" w="0.039"  />
    <Component name="Sn" a="118.7" z="50" w="0.059"  />
  </Mixture>

  <Mixture name="CuAlNovecMix" dens="0.673"  >
    <Component name="Cu" a="63.5" z="29" w="0.856" />
    <Component name="Al" a="27" z="13" w="0.063" />
    <Component name="O" a="16" z="8"  w="0.081*0.061" />
    <Component name="H" a="1"  z="1"  w="0.081*0.019" />
    <Component name="C" a="12" z="6"  w="0.081*0.272"  />
    <Component name="F" a="9"  z="19" w="0.081*0.648"  />
  </Mixture>

  <Mixture name="AlNovecMix" dens="1.961"  >
  <Component name="Al" a="27" z="13" w="0.57" />
  <Component name="O" a="16" z="8"  w="0.43*0.061" />
  <Component name="H" a="1"  z="1"  w="0.43*0.019" />
  <Component name="C" a="12" z="6"  w="0.43*0.272"  />
  <Component name="F" a="9"  z="19" w="0.43*0.648"  />
  </Mixture>

  raddeg = 3.14159265/180.0

  <!-- Radius of IBMO center to ladder mother volume IBAM center -->
  ModuleRadius = 13.9254

  <!-- Ladder thickness -->
  Ladder_Thk = HalfLadThk*2
  Ladder_Width = HalfLadWdt*2
  Ladder_Length = HalfLadLen*2
    
  debug = 0
 
  <!-- ICCM volume declaration -->
<!-- IST cables and cooling line in transition area and PIT -->
 

 <Create    block="ICCT" />
 <Placement block="ICCT" in="IDSM"  x="0.0" y="0.0" z="-53.0448-0.5*8.7144"/>

 <Do var="nCableSet" from="1" to="24">
         anglePIT_A=(360.0/24)*(nCableSet-1)-7.396
         anglePIT_B=(360.0/24)*(nCableSet-1)-9.337
         anglePIT_C=(360.0/24)*(nCableSet-1)-11.279
         anglePIT_T=(360.0/24)*(nCableSet-1)-4.045

        <Create    block="ICCA"/>
        <Placement block="ICCA" konly="'ONLY'" in="IDSM" x="24.3728*sin(anglePIT_A*raddeg)" y="24.3728*cos(anglePIT_A*raddeg)" z="-231.9392+0.5*170.18" />
        <Placement block="ICCA" konly="'ONLY'" in="IDSM" x="24.3728*sin(anglePIT_B*raddeg)" y="24.3728*cos(anglePIT_B*raddeg)" z="-231.9392+0.5*170.18" />
        <Placement block="ICCA" konly="'ONLY'" in="IDSM" x="24.3728*sin(anglePIT_C*raddeg)" y="24.3728*cos(anglePIT_C*raddeg)" z="-231.9392+0.5*170.18" />

        <Create    block="ICCL"/>
        <Placement block="ICCL" konly="'ONLY'" in="IDSM" x="24.3855*sin(anglePIT_T*raddeg)" y="24.3855*cos(anglePIT_T*raddeg)" z="-231.9392+0.5*170.18" />

	<Create    block="ICLP"/>
	<Placement block="ICLP" konly="'ONLY'" in="IDSM" x="24.3855*sin(anglePIT_T*raddeg)" y="24.3855*cos(anglePIT_T*raddeg)" z="-231.9392+0.5*170.18" />

 </Do>

  <Create    block="IBMO"/>
  <Placement block="IBMO" in="IDSM" konly="ONLY"/>


  <!-- IBMO volume declaration -->
  <Volume name="IBMO" comment="Main volume of IST detector">
  <Material name="Air"/>
  <Attribute for="IBMO" seen="0" colo="1"/>
  <Shape type="PCON" nz="4" phi1="0" dphi="360"
	 zi="{-12.957-Ladder_Length/2.0, -4.5 -Ladder_Length/2.0,
              -4.5-Ladder_Length/2.0,    Ladder_Length/2.0}"
	 rmn="{ IBMOInnerRadius+0.2, IBMOInnerRadius+0.2, IBMOInnerRadius, IBMOInnerRadius}"
	 rmx="{ IBMOOuterRadius,     IBMOOuterRadius,     IBMOOuterRadius, IBMOOuterRadius}" />

   <Do var="nl" from="1" to="nLadder">
     <!-- quick way to rotate ladder-->
     aangle=(360.0/nLadder)*(nl-1) + angleOffset

     <If expr="debug==1"  >
     <Info format="shift in X ={6.4f}"> PARO_DX*PARO_mult </Info>
     <Info format="shift in Y ={6.4f}"> PARO_DY*PARO_mult </Info>
     <Info format="shift in Z ={6.4f}"> PARO_DZ*PARO_mult </Info>
     </If>

     xpos=0.0 + (PARO_DX*PARO_mult)*PARO_lad(nl) 
     ypos=0.0 + (PARO_DY*PARO_mult)*PARO_lad(nl)
     zpos=0.0 + (PARO_DZ*PARO_mult)*PARO_lad(nl)

     <If expr="debug==1"  >
     <Info format="aangle={8.5f}"> aangle </Info>
     <Info format="x={8.5f}"> xpos </Info>
     <Info format="y={8.5f}"> ypos </Info>
     <Info format="z={8.5f}"> zpos </Info>
     </If>

     <Create block="IBAM"/>
     <!-- Note the ladder active area center is not in accordance with the IBMO center in z direction -->
     <!-- the shift distance equals to OutsideTubeWestLen+2*HalfEndcapMomLen+2*HalfSenMomLen*3-HalfLadLen -->
     <Placement in="IBMO" x="xpos" y="ypos" z="zpos-4.4929" block="IBAM" konly="'MANY'">

        <If expr="debug==1"  >
        <Info format="rot along X ={6.4f}"> PARA_DA*PARA_mult </Info>
        <Info format="rot along Y ={6.4f}"> PARA_DB*PARA_mult </Info>
        <Info format="rot along Z ={6.4f}"> PARA_DG*PARA_mult </Info>
        </If>

        <Rotation alphaz="(-1*aangle)-1*(PARA_DG*PARA_mult*PARA_lad(nl))"/>
        <Rotation alphax="-1*(PARA_DA*PARA_mult)*PARA_lad(nl)"/>
        <Rotation alphay="-1*(PARA_DB*PARA_mult)*PARA_lad(nl)"/>
     </Placement>
   </Do>
   <!-- end Loop over ladders-->

   <!-- Place west side cooling loops -->
   <Do var="nCTJ" from="1" to="12">
      bangle=(360.0/12.0)*(nCTJ-1)+5.73
      <Create    block="IBCJ"/> 
      <Placement block="IBCJ" konly="'MANY'" in="IBMO" x="xctjpos(nCTJ)" y="yctjpos(nCTJ)" z="zpos+35.5965+0.5*11.4588" >
      <Rotation alphaz="-1.0*bangle"/>
      </Placement>
   </Do> 

   <!-- Place short purple cables and cooling tubes from t-board to transition area -->
   radius_A=16.3832
   radius_B=16.8956
   radius_C=17.2478
   radius_T=15.0929
   tilt_A=0.8824
   tilt_B=-3.5681
   tilt_C=-6.0912
   tilt_T=-1.7697
   <Do var="nCableSet" from="1" to="24">
	angle_A=(360.0/24)*(nCableSet-1)+tilt_A
	angle_B=(360.0/24)*(nCableSet-1)+tilt_B
	angle_C=(360.0/24)*(nCableSet-1)+tilt_C
	angle_T=(360.0/24)*(nCableSet-1)+tilt_T

   	<Create     block="ISCA"/>
   	<Placement  block="ISCA" konly="'ONLY'" in="IBMO" x="radius_A*sin(angle_A*raddeg)" y="radius_A*cos(angle_A*raddeg)" z="-34.7832-0.5*18.2616">
   	<Rotation alphaz="-1.0*angle_A"/>
   	</Placement>

   	<Create    block="ISCB"/>
   	<Placement block="ISCB" konly="'ONLY'" in="IBMO" x="radius_B*sin(angle_B*raddeg)" y="radius_B*cos(angle_B*raddeg)" z="-32.1233-0.5*20.9215" >
   	<Rotation alphaz="-1.0*angle_B"/>
   	</Placement>

   	<Create block="ISCC"/>
   	<Placement block="ISCC" konly="'ONLY'" in="IBMO" x="radius_C*sin(angle_C*raddeg)" y="radius_C*cos(angle_C*raddeg)" z="-29.203-0.5*23.8418" >
   	<Rotation alphaz="-1.0*angle_C"/>
   	</Placement>
<!-- NOTE: ISCT can be simplified into a polycone, with coolant inside. -->
   	<Create block="ISCT"/>
   	<Placement block="ISCT" konly="'ONLY'" in="IBMO" x="radius_T*sin(angle_T*raddeg)" y="radius_T*cos(angle_T*raddeg)" z="-44.5806-0.5*8.4642" >
   	<Rotation alphaz="-1.0*angle_T"/>
   	</Placement>


   </Do>
 </Volume> 

 <!-- volume to contain cooling loops in west side -->
 <Volume name="IBCJ" comment="IST cooling loops and joints ">
 <Material name="Air" />
 <Attribute for="IBCJ" seen="0" colo="6"/>
 <Shape type="BOX" dx="2.88855" dy="0.91655" dz="5.7294"/>
     <!-- placement of sub-volumes -->
     <Do var="nSeg" from="1" to="20">
	tubeAngle=raddeg*(2*nSeg-1)*180/(2.0*20)
        xtubeArc=-2.88855+0.5*1.8331+1.97-1.97*cos(tubeAngle)
        ytubeArc=0.0
        ztubeArc=-5.7294+2.722875+0.1778+6.35+1.97*sin(tubeAngle)
        <Create    block="ICJR"  />
	<Placement block="ICJR" in="IBCJ" x="xtubeArc" y="ytubeArc" z="ztubeArc">
	<Rotation alphay="(2*nSeg-1)*180/(2.0*20)"/>
	</Placement>
     </Do>

   
  <!-- NOTE: ICJS, ICJA, ICJU can be merged into a polycone.  ICLN should be contained inside. -->

     <Create    block="ICJS" />
     <Placement block="ICJS" in="IBCJ"  x="2.88855-0.5*1.8331" y="0.0" z="-5.7294+2.722875+0.1778+0.5*6.35"/>
     <Placement block="ICJS" in="IBCJ"  x="-2.88855+0.5*1.8331" y="0.0" z="-5.7294+2.722875+0.1778+0.5*6.35"/>

     <Create    block="ICJA" />
     <Placement block="ICJA" in="IBCJ"  x="-2.88855+0.5*1.8331" y="0.0" z="-5.7294+2.722875+0.5*0.1778"/>
     <Placement block="ICJA" in="IBCJ"  x="2.88855-0.5*1.8331" y="0.0" z="-5.7294+2.722875+0.5*0.1778"/>

     <Create    block="ICJU" />
     <Placement block="ICJU" in="IBCJ"  x="-2.88855+0.5*1.8331" y="0.0" z="-5.7294+0.5*2.722875"/>
     <Placement block="ICJU" in="IBCJ"  x="2.88855-0.5*1.8331" y="0.0" z="-5.7294+0.5*2.722875"/>

     <Create    block="ICLN" />
     <Placement block="ICLN" in="IBCJ"  x="-2.88855+0.5*1.8331" y="0.0" z="-5.7294+0.5*2.722875+0.5*0.1778+0.5*6.35"/>
     <Placement block="ICLN" in="IBCJ"  x="2.88855-0.5*1.8331" y="0.0" z="-5.7294+0.5*2.722875+0.5*0.1778+0.5*6.35"/>
 </Volume>

 <!-- sub-volume construction -->
 <Volume name="ICJR" comment="cooling loop arc part">
 <Attribute for="ICJR" seen="1" colo="4"/>
 <Material name="AlNovecMix"/>
 <Shape type="TUBE" rmin="0" rmax="0.238125" dz="0.5*3.1415926*1.97/20" />
 </Volume>
	

 <Volume name="ICJS" comment="cooling loop tube part right">
 <Attribute for="ICJS" seen="1" colo="4"/>
 <Material name="Aluminium"/>
 <Shape type="TUBE" rmin="0.18225" rmax="0.238125" dz="3.175" />
 </Volume>

 <Volume name="ICJA" comment="cooling loop cone part left">
 <Attribute for="ICJA" seen="1" colo="4"/>
 <Material name="Aluminium"/>
 <Shape type="CONE" rmn1="0.5*0.6325" rmx1="0.5*0.7442" rmn2="0.5*0.3645" rmx2="0.5*0.47625" dz="0.5*0.1778" />
 </Volume>

 <Volume name="ICJU" comment="cooling loop connector left">
 <Attribute for="ICJU" seen="1" colo="4"/>
 <Material name="Aluminium"/>
 <Shape type="TUBE" rmin="0.18225" rmax="0.5*1.8331" dz="0.5*2.722875" />
 </Volume>

 <Volume name="ICLN" comment="cooling liquid through ICJN, ICJA and ICJU volumes">
 <Attribute for="ICLN" seen="1" colo="920"/>
 <Material name="NOVEC7200"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*0.3645" dz="0.5*2.722875+0.5*0.1778+0.5*6.35" />
 </Volume>

 <!-- volumes for short cables and cooling tube from stave to transition area -->
 <Volume name="ISCA" comment="IST short purple cable A in transition cone">
 <Material name="copper" />
 <Attribute for="ISCA" seen="1" colo="629"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*cableDiameter" dz="0.5*18.2616"/>
 </Volume>

 <Volume name="ISCB" comment="IST short purple cable B in transition cone">
 <Material name="copper" />
 <Attribute for="ISCB" seen="1" colo="629"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*cableDiameter" dz="0.5*20.9215"/>
 </Volume>

 <Volume name="ISCC" comment="IST short purple cable C in transition cone">
 <Material name="copper" />
 <Attribute for="ISCC" seen="1" colo="629"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*cableDiameter" dz="0.5*23.8418"/>
 </Volume>

<!-- NOTE: ISCT polycone -->
 <Volume name="ISCT" comment="IST short cooling tube in transition cone ">
 <Material name="Air" />
 <Attribute for="ISCT" seen="0" colo="6"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*1.8331" dz="0.5*8.4642"/>
      <Create    block="ICTJ" />
      <Placement block="ICTJ" in="ISCT"  x="0.0" y="0.0" z="0.5*8.4642-0.5*2.8889"/>

      <Create    block="ICTA" />
      <Placement block="ICTA" in="ISCT"  x="0.0" y="0.0" z="0.5*8.4642-2.8889-0.5*0.1778"/>

      <Create    block="ICTB" />
      <Placement block="ICTB" in="ISCT"  x="0.0" y="0.0" z="-0.5*8.4642+0.5*5.3975"/>

      <Create block="ICLE"/>
      <Placement block="ICLE" in="ISCT" x="0.0" y="0.0" z="0.0" />
 </Volume>


 <Volume name="ICLE" comment="cooling liquid in ISCT volume">
 <Attribute for="ICLE" seen="1" colo="920"/>
 <Material name="NOVEC7200"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*0.5334" dz="0.5*8.4642" />
 </Volume>


 <Volume name="ICTA" comment="cooling tube cone part">
 <Attribute for="ICTA" seen="1" colo="4"/>
 <Material name="Aluminium"/>
 <Shape type="CONE" rmn1="0.5*0.5334" rmx1="0.5*0.635" rmn2="0.5*0.8014" rmx2="0.5*0.903" dz="0.5*0.1778" />
 </Volume>

 <Volume name="ICTJ" comment="cooling tube connector left">
 <Attribute for="ICTJ" seen="1" colo="4"/>
 <Material name="Aluminium"/>
 <Shape type="TUBE" rmin="0.5*0.5334" rmax="0.5*1.8331" dz="0.5*2.8889" />
 </Volume>

 <Volume name="ICTB" comment="cooling tube part">
 <Attribute for="ICTB" seen="1" colo="4"/>
 <Material name="Aluminium"/>
 <Shape type="TUBE" rmin="0.5*0.5334" rmax="0.5*0.635" dz="0.5*5.3975" />
 </Volume>

 <!-- IST ladder volumes (each including six silicon sensors, cooling and support materials) -->
 <Volume name="IBAM" comment="IST ladder">
 <Material name="Air" />
 <Attribute for="IBAM" seen="1" colo="6"/>
 <Shape type="TUBS" rmin="11.84" rmax="17.5" phi1="-18+90" phi2="18+90"  dz="Ladder_Length/2.0"/>
 
   <!-- placement of sub-volumes -->
   <Create    block="ILCC"  />
   x= HalfLadWdt-0.15-HalfCombWdt
   y=-HalfLadThk+2.4244+2*HalfSkinThk+HalfCombThk
   <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
   <Placement block="ILCC" in="IBAM" x="xp" y="yp" z="HalfLadLen-HalfCombLen-2*HalfEndcapMomLen-OutsideTubeWestLen">
     <Rotation alphaz="-1.0*Tilt"/>
   </Placement>
   <!-- Carbon foam assembly.  Could reorganize grooves to remove many/only subtraction. -->
   <Create    block="IBCF"  />
   x=-HalfLadWdt+DistFoamToLadder+HalfFoamWdt
   y=HalfFoamThk+2.4244-HalfLadThk+2*HalfSkinThk
   <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
   <Placement block="IBCF" in="IBAM" konly="MANY" 
	      x="xp" 
	      y="yp"
	      z="HalfLadLen-HalfFoamLen-2*HalfEndcapMomLen-OutsideTubeWestLen" >
     <Rotation alphaz="-1.0*Tilt"/>
     
   </Placement>

<!-- NOTE: Reorganize... box within a box -->
     <Create    block="ILST"  />
     x=HalfLadWdt-HalfSkinWdt-0.15
     y=-HalfLadThk+2*HalfCombThk+2.4244+3*HalfSkinThk-HalfThkAirInHbd
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement in="IBAM" x="xp" y="yp" z="HalfLadLen-HalfSkinLen-OutsideTubeWestLen-1.75" block="ILST">
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
<!-- NOTE: Reorganize... box within a box -->
     <Create    block="ILSB"  />
     x=HalfLadWdt-HalfSkinWdt-0.15
     y=-HalfLadThk+2.4244+HalfSkinThk+HalfThkAirInHbd
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement in="IBAM" x="xp" y="yp" z="HalfLadLen-HalfSkinLen-OutsideTubeWestLen-1.75" block="ILSB">
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
<!-- NOTE: Reorganize... box within a box -->
     <Create    block="IBHT"  />
     x=HalfLadWdt-HalfHbdWdtTB-0.15
     y=-HalfLadThk+4*HalfSkinThk+2*HalfCombThk+2.4244+HalfHbdThkTB-HalfThkAirInHbd
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement in="IBAM" x="xp" y="yp" z="HalfLadLen-HalfHbdLenTB-OutsideTubeWestLen-1.75" block="IBHT">
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
<!-- NOTE: Reorganize... box within a box -->
     <Create    block="IBHB"  />
     x=HalfLadWdt-HalfHbdWdtTB-0.15
     y=-HalfLadThk+2.4244-HalfHbdThkTB+HalfThkAirInHbd
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement in="IBAM" x="xp" y="yp" z="HalfLadLen-HalfHbdLenTB-OutsideTubeWestLen-1.75" block="IBHB">
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IBHC"  />
     x=-HalfLadWdt+DistFoamToLadder
     y=-HalfLadThk+HalfFoamThk+2.4244+2*HalfSkinThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement in="IBAM" x="xp" y="yp" z="HalfLadLen-HalfHbdArcLen-OutsideTubeWestLen-1.75" block="IBHC">
         <Rotation alphaz="-1.0*Tilt"/>
     </Placement>

<!-- NOTE: Tube with hole in it... -->
     <!-- placement of tube -->
     <Create    block="IBAT"  />
     x=-HalfLadWdt+DistFoamToLadder+HalfFoamWdt+TubeRmax
     y=HalfLadThk-2*HalfTBoardThk-2*HalfTBslotThk-2*HalfHbdThkTB-2*HalfSkinThk-DistTubeTopSkin
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IBAT"  konly="MANY"
		x="xp" 
		y="yp"
		z="HalfTubeLen-HalfLadLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
 
     <Create    block="IBCW"  /> <!-- Cooling liquid located in a tube somewhere... -->
     x=-HalfLadWdt+DistFoamToLadder+HalfFoamWdt+TubeRmax
     y=HalfLadThk-2*HalfTBoardThk-2*HalfTBslotThk-2*HalfHbdThkTB-2*HalfSkinThk-DistTubeTopSkin
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IBCW"  
		x="xp"
		y="yp"
		z="LiquidInTubeLen-HalfLadLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
         
     <!-- placement of transit board-->
     <Create    block="IBRB"  />
     x=-HalfLadWdt+HalfTBoardWdt
     y=HalfLadThk-HalfTBoardThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IBRB"  x="xp" y="yp" z="-HalfLadLen+OutsideTubeEastLen-OutsideTBoardLen+HalfTBoardLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IRSA"  />
     x=-HalfLadWdt+DistFoamToLadder+DistSlotCtoFoam+5*HalfTBslotWdt+2*TBSlotGapSize
     y=HalfLadThk-2*HalfTBoardThk-HalfTBslotThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IRSA"  x="xp" y="yp" z="-HalfLadLen+OutsideTubeEastLen+1.75+0.03+HalfTBslotLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IRSB"  />
     x=-HalfLadWdt+DistFoamToLadder+DistSlotCtoFoam+3*HalfTBslotWdt+TBSlotGapSize
     y=HalfLadThk-2*HalfTBoardThk-HalfTBslotThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IRSB"  x="xp" y="yp" z="-HalfLadLen+OutsideTubeEastLen+1.75+0.03+3*HalfTBslotLen-OverlapSlotsLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IRSC"  />
     x=-HalfLadWdt+DistFoamToLadder+DistSlotCtoFoam+HalfTBslotWdt
     y=HalfLadThk-2*HalfTBoardThk-HalfTBslotThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IRSC"  x="xp" y="yp" z="-HalfLadLen+OutsideTubeEastLen+1.75+0.03+5*HalfTBslotLen-2*OverlapSlotsLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IBTS"  />
     x=-HalfLadWdt+DistFoamToLadder+0.2581+0.5*0.1625
     y=2.4244-2*HalfHbdThkTB-HalfLadThk-0.5*0.06
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement in="IBAM" x="xp" y="yp" z="-HalfLadLen+OutsideTubeEastLen+21.0235+0.5*0.1625" block="IBTS">
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IECW"  />  <!-- overlaping with cooling liquid IBCW -->
     x=HalfLadWdt-HalfEndcapMomWdt-0.15
     y=HalfEndcapMomThk+2.4244-HalfLadThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IECW" in="IBAM" konly="MANY"
		x="xp"
		y="yp"
		z="HalfLadLen-OutsideTubeWestLen-HalfEndcapMomLen" >

       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>
     
     <Create    block="IECE"  /> <!-- overlaping with cooling liquid IBCW -->
     x=HalfLadWdt-HalfEndcapMomWdt-0.15
     y=HalfEndcapMomThk+2.4244-HalfLadThk
     <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
     <Placement block="IECE" in="IBAM" konly="MANY" 
		x="xp" 
		y="yp"
		z="-HalfLadLen+OutsideTubeEastLen+HalfEndcapMomLen" >
       <Rotation alphaz="-1.0*Tilt"/>
     </Placement>

   
  
  <!-- taking care of the silicon sensor numbering in a ladder -->
  <Do var="nu" from="1" to="nUnit">
       <Create block="IBLM"/>

       x=HalfLadWdt-HalfSenMomWdt-DistSensorToLadder-0.15
       y=2.4244-2*HalfHbdThkTB-HalfSenMomThk-HalfLadThk
       <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
       <If expr="debug==1"  >
	 <Info format="xl {7.4f}"> x  </Info>
	 <Info format="yl {7.4f}"> y  </Info>
	 <Info format="xp {7.4f}"> xpos  </Info>
	 <Info format="yp {7.4f}"> ypos  </Info>
       </If>
       <Placement in="IBAM" x="xp" y="yp" z="-1.0*HalfLadLen+DistLadderToIBLM+HalfSenMomLen*(2*nu-1)" konly="ONLY" block="IBLM">
         <Rotation alphaz="-1.0*Tilt"/>
       </Placement>
  </Do>
  <!-- end loop over sensors-->

  <!-- Create screw mother volume ISCM       November 8 2012 Yaping -->
     <Do var="nsc" from="1" to="2">
         <Create    block="ISCM"/>
	 x=HalfLadWdt-HalfEndcapMomWdt-0.15
	 y=-HalfLadThk+2.4244+2*HalfEndcapMomThk-0.2845
	 <Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
         <Placement block="ISCM" in="IBAM" konly="MANY"
		    x="xp"
		    y="yp"
		    z="-HalfLadLen+OutsideTubeEastLen+0.75+(1.5+HalfCombLen)*(2*nsc-2)" >
           <Rotation alphaz="-1.0*Tilt"/>
	 </Placement>
     </Do>

  <!-- Create support ring mother volume       October 1 2012 Yaping -->
     <Do var="ns" from="1" to="2">
        <Create    block="IBSR"/>
	x=HalfLadWdt-1.0*HalfSRMomWdt
	y=HalfSRMomThk-1.0*HalfLadThk
	<Call routine="trans_to_ibam"  expr="x,y,Tilt,xp,yp"/>
        <Placement block="IBSR" in="IBAM" konly="MANY"
		   x="xp"
		   y="yp"
		   z="-HalfLadLen+9.9143+HalfSRMomLen+58.88*(ns-1)" >
           <Rotation alphaz="-1.0*Tilt"/>
	 </Placement>
	 
     </Do>
 </Volume>

    <!-- here we define shapes -->
    <!-- volumes for Choneycomb-->
    <Volume name="ILCC" comment="Choneycomb mother volume" >
        <Attribute for="ILCC" seen="0" colo="1"/>
        <Material name="Air"/>
        <Shape type="BOX" dx="HalfCombWdt" dy="HalfCombThk" dz="HalfCombLen"/>
        <Create block="ICCU"/>
        <Placement block="ICCU" x="0.0" y="0.0" z="-HalfCombLen+HalfCombLenConnect"/>
        <Create block="ICCD"/>
        <Placement block="ICCD" x="0.0" y="0.0" z="HalfCombLenConnect"/>
    </Volume>
    
    <Volume name="ICCU" comment="is the IST carbon honeycomb BOX volume on east side">
        <Material name="CFRPMix" />
        <Attribute for="ICCU" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfCombWdt" dy="HalfCombThkConnect" dz="HalfCombLenConnect"/>
    </Volume>
    
    <Volume name="ICCD" comment="is the IST carbon honeycomb BOX volume on west side">
        <Material name="CFRPMix" />
        <Attribute for="ICCD" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfCombWdt" dy="HalfCombThk" dz="HalfCombLen-HalfCombLenConnect"/>
    </Volume>
    
    <!-- volumes for CFoam -->
    <Volume name="IBCF" comment="mother of the CFoam assembly"  >
        <Material name="Air"  />
        <Attribute for="IBCF" seen="0" colo="1"  />
        <Shape type="BOX" dx="HalfFoamWdt" dy="HalfFoamThk" dz="HalfFoamLen"/>
        <Create    block="ICFC"/><!-- foam -->
        <Placement block="ICFC" konly="MANY" x="0.0" y="0.0" z="-HalfFoamLen+HalfFoamLenConnect"/>
        <Create    block="ICFD"/><!-- foam -->
        <Placement block="ICFD" konly="MANY" x="0.0" y="0.0" z="HalfFoamLenConnect"/>
        <Create    block="ICFB"/><!-- groove in ICFC and D -->
        <Placement block="ICFB" konly="ONLY" x="TubeRmax" y="HalfFoamThk-0.2922/2.0" z="0.0"/>
        <Create    block="ICFA"/><!-- groove in ICFC and D -->
        <Placement block="ICFA" konly="ONLY" x="TubeRmax" y="HalfFoamThk-0.2922" z="0.0"/>
    </Volume>
    
    <Volume name="ICFC" comment="is the IST carbon foam BOX volume on east side">
        <Material name="CARBONFOAM" />
        <Attribute for="ICFC" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfFoamWdt" dy="HalfFoamThkConnect" dz="HalfFoamLenConnect"/>
    </Volume>
    
    <Volume name="ICFD" comment="is the IST carbon foam BOX volume on west side">
        <Material name="CARBONFOAM" />
        <Attribute for="ICFD" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfFoamWdt" dy="HalfFoamThk" dz="HalfFoamLen-HalfFoamLenConnect"/>
    </Volume>
    
    <Volume name="ICFB" comment="is the CFoam air groove box Area">
        <Material name="Air" />
        <Attribute for="ICFB" seen="1" colo="1"/>
        <Shape type="BOX" dx="TubeRmax" dy="0.2922/2.0" dz="HalfFoamLen"/>
    </Volume>
    
    <Volume name="ICFA" comment="is the CFoam air groove arc Area">
        <Material name="Air" />
        <Attribute for="ICFA" seen="1" colo="1"/>
        <Shape type="TUBS" rmin="0" rmax="TubeRmax" dz="HalfFoamLen" phi1="180.0" phi2="360.0" />
    </Volume>
    
    <!-- volume for cooling tube-->
    <Volume name="IBAT" comment="Aluminium cooling tube mother volume">
        <Attribute for="IBAT" seen="0" colo="1"/>
        <Material name="Air"/>
        <Shape type="TUBE" rmin="0" rmax="TubeConeOuterRmax" dz="HalfTubeLen"/>
        <Create    block="ICTC"/>
	<Placement block="ICTC" x="0.0" y="0.0" z="0.0"/>
	<Create    block="ICTE"/>
	<Placement block="ICTE" x="0.0" y="0.0" z="-HalfTubeLen+HalfTubeConeLen"/>
	<Create    block="ICTW"/>
	<Placement block="ICTW" x="0.0" y="0.0" z="HalfTubeLen-HalfTubeConeLen"/>
    </Volume>

    <Volume name="ICTC" comment="Aluminium cooling tube cylinder">
        <Attribute for="ICTC" seen="1" colo="4"/>
        <Material name="Aluminium"/>
        <Shape type="TUBE" rmin="TubeRmin" rmax="TubeRmax" dz="HalfTubeLen-HalfTubeConeLen"/>
    </Volume>

    <Volume name="ICTE" comment="Aluminium cooling tube cone connector east side">
	<Attribute for="ICTE" seen="1" colo="4"/>
	<Material name="Aluminium"/>    
	<Shape type="CONE" rmn1="TubeConeOuterRmin" rmx1="TubeConeOuterRmax" rmn2="TubeRmin" rmx2="TubeRmax" dz="HalfTubeConeLen" />
    </Volume>

    <Volume name="ICTW" comment="Aluminium cooling tube cone connector west side">
        <Attribute for="ICTW" seen="1" colo="4"/>
        <Material name="Aluminium"/>        
        <Shape type="CONE" rmn1="TubeRmin" rmx1="TubeRmax" rmn2="TubeConeOuterRmin" rmx2="TubeConeOuterRmax" dz="HalfTubeConeLen" />
    </Volume>

    <!-- volume for cooling liquid-->
    <Volume name="IBCW" comment="cooling liquid in Alumnium tube">
        <Attribute for="IBCW" seen="1" colo="920"/>
        <Material name="NOVEC7200"/>
        <Shape type="TUBE" rmin="0.0" rmax="TubeRmin" dz="HalfTubeLen" />
    </Volume>
    
    <!--update ILST geometry for top CF skin due to hybrid thickness  January 9 2013 -->
    <Volume name="ILST" comment="CF Skin top layer mother volume" >
        <Attribute for="ILST" seen="0" colo="1"/>
        <Material name="Air"/>
        <Shape type="BOX" dx="HalfSkinWdt" dy="HalfThkSkinMom" dz="HalfSkinLen"/>
        <Create block="ISTC"/>
        <Placement block="ISTC" x="0.0" y="-HalfThkSkinMom+HalfSkinThk" z="HalfLenSkinConnect-HalfSkinLen"/>
        <Create block="ISTH"/>
        <Placement block="ISTH" x="0.0" y="-HalfSkinThk+HalfThkSkinMom" z="HalfLenSkinConnect"/>
    </Volume>
    
    <Volume name="ISTC" comment="is the CF skin BOX volume on connecter side in TOP CF skin mother volume">
        <Material name="CFRPMix2" />
        <Attribute for="ISTC" seen="1" colo="3"/>
        <Shape type="BOX" dx="HalfSkinWdt" dy="HalfSkinThk" dz="HalfLenSkinConnect"/>
    </Volume>
    
    <Volume name="ISTH" comment="is the CF skin BOX volume on west side in TOP CF skin mother volume">
        <Material name="CFRPMix2" />
        <Attribute for="ISTH" seen="1" colo="3"/>
        <Shape type="BOX" dx="HalfSkinWdt" dy="HalfSkinThk" dz="HalfSkinLen-HalfLenSkinConnect"/>
    </Volume>
    
    
    <!--update ILSB geometry for bottom CF skin due to hybrid thickness  January 9 2013 -->
    <Volume name="ILSB" comment="CF Skin bottom layer mother volume" >
        <Attribute for="ILSB" seen="0" colo="1"/>
        <Material name="Air"/>
        <Shape type="BOX" dx="HalfSkinWdt" dy="HalfThkSkinMom" dz="HalfSkinLen"/>
        <Create block="ISBC"/>
        <Placement block="ISBC" x="0.0" y="HalfThkSkinMom-HalfSkinThk" z="HalfLenSkinConnect-HalfSkinLen"/>
        <Create block="ISBH"/>
        <Placement block="ISBH" x="0.0" y="-HalfThkSkinMom+HalfSkinThk" z="HalfLenSkinConnect"/>
    </Volume>
    
    <Volume name="ISBC" comment="is the CF skin BOX volume on connecter side in BOTTOM CF skin mother volume">
        <Material name="CFRPMix2" />
        <Attribute for="ISBC" seen="1" colo="3"/>
        <Shape type="BOX" dx="HalfSkinWdt" dy="HalfSkinThk" dz="HalfLenSkinConnect"/>
    </Volume>
    
    <Volume name="ISBH" comment="is the CF skin BOX volume on west side in BOTTOM CF skin mother volume">
        <Material name="CFRPMix2" />
        <Attribute for="ISBH" seen="1" colo="3"/>
        <Shape type="BOX" dx="HalfSkinWdt" dy="HalfSkinThk" dz="HalfSkinLen-HalfLenSkinConnect"/>
    </Volume>
    
    
    <!--update IBHT geometry due to hybrid thickness  January 9 2013 -->
    <Volume name="IBHT" comment="Kapton hybrid TOP layer mother volume" >
        <Attribute for="IBHT" seen="0" colo="1"/>
        <Material name="Air"/>
        <Shape type="BOX" dx="HalfHbdWdtTB" dy="HalfHbdThkTBConnect" dz="HalfHbdLenTB"/>
        <Create block="IHTC"/>
        <Placement block="IHTC" x="0.0" y="0.0" z="-HalfHbdLenTB+HalfHbdLenTBConnect"/>
        <Create block="IHTH"/>
        <Placement block="IHTH" x="0.0" y="-HalfHbdThkTB+HalfHbdThkTBConnect" z="HalfHbdLenTBConnect"/>
    </Volume>
    
    <Volume name="IHTC" comment="is the hybrid on connecter side in TOP hybrid mother volume">
        <Material name="KAPTON" />
        <Attribute for="IHTC" seen="1" colo="2"/>
        <Shape type="BOX" dx="HalfHbdWdtTB" dy="HalfHbdThkTBConnect" dz="HalfHbdLenTBConnect"/>
    </Volume>
    
    <Volume name="IHTH" comment="is the hybird on west side in TOP hybrid mother volume">
        <Material name="KAPTON" />
        <Attribute for="IHTH" seen="1" colo="2"/>
        <Shape type="BOX" dx="HalfHbdWdtTB" dy="HalfHbdThkTB" dz="HalfHbdLenTB-HalfHbdLenTBConnect"/>
    </Volume>
    
    
    <!--update IBHB geometry due to hybrid thickness  January 9 2013 -->
    <Volume name="IBHB" comment="Kapton hybrid BOTTOM layer mother volume" >
        <Attribute for="IBHB" seen="0" colo="1"/>
        <Material name="Air"/>
        <Shape type="BOX" dx="HalfHbdWdtTB" dy="HalfHbdThkTBConnect" dz="HalfHbdLenTB"/>
        <Create block="IHBC"/>
        <Placement block="IHBC" x="0.0" y="0.0" z="-HalfHbdLenTB+HalfHbdLenTBConnect"/>
        <Create block="IHBH"/>
        <Placement block="IHBH" x="0.0" y="HalfHbdThkTB-HalfHbdThkTBConnect" z="HalfHbdLenTBConnect"/>
    </Volume>
    
    <Volume name="IHBC" comment="is the hybrid on connecter side in BOTTOM hybrid mother volume">
        <Material name="KAPTON" />
        <Attribute for="IHBC" seen="1" colo="2"/>
        <Shape type="BOX" dx="HalfHbdWdtTB" dy="HalfHbdThkTBConnect" dz="HalfHbdLenTBConnect"/>
    </Volume>
    
    <Volume name="IHBH" comment="is the hybrid on west side in BOTTOM hybrid mother volume">
        <Material name="KAPTON" />
        <Attribute for="IHBH" seen="1" colo="2"/>
        <Shape type="BOX" dx="HalfHbdWdtTB" dy="HalfHbdThkTB" dz="HalfHbdLenTB-HalfHbdLenTBConnect"/>
    </Volume>
    
    <!--update IBHC geometry due to hybrid thickness  January 9 2013 -->
    <Volume name="IBHC" comment="Kapton Hybrid north Arc layer mother volume" >
        <Attribute for="IBHC" seen="1" colo="2"/>
        <Material name="KAPTON"/>
        <Shape type="TUBS" rmin="HbdArcRmin" rmax="HbdArcRmax" dz="HalfHbdArcLen" phi1="90.0" phi2="270.0"/>
        <Create block="IHCA"/>
        <Placement block="IHCA" x="0.0" y="0.0" z="-AirInHbdHalfLen+HalfHbdArcLen"/>
    </Volume>
    
    <Volume name="IHCA" comment="is the Inner air layer in north ARC hybrid mother volume">
        <Material name="Air" />
        <Attribute for="IHCA" seen="1" colo="1"/>
        <Shape type="TUBS" rmin="HbdArcRmin" rmax="AirInHbdArcRmax" dz="AirInHbdHalfLen" phi1="90.0" phi2="270.0" />
    </Volume>
    
    <!-- volumes to t-board --> 
    <Volume name="IBRB" comment="Transit board" >
        <Attribute for="IBRB" seen="1" colo="629"/>
        <Material name="G10"/>
        <Shape type="BOX" dx="HalfTBoardWdt" dy="HalfTBoardThk" dz="HalfTBoardLen"/>
    </Volume>
    
    <!-- volumes to readout connectors mounted on hybrid backside -->
    <Volume name="IRSA" comment="Transit board slot A" >
        <Attribute for="IRSA" seen="1" colo="1"/>
        <Material name="DELRIN"/>
        <Shape type="BOX" dx="HalfTBslotWdt" dy="HalfTBslotThk" dz="HalfTBslotLen"/>
    </Volume>
    
    <Volume name="IRSB" comment="Transit board slot B" >
        <Attribute for="IRSB" seen="1" colo="1"/>
        <Material name="DELRIN"/>
        <Shape type="BOX" dx="HalfTBslotWdt" dy="HalfTBslotThk" dz="HalfTBslotLen"/>
    </Volume>
    
    <Volume name="IRSC" comment="Transit board slot C" >
        <Attribute for="IRSC" seen="1" colo="1"/>
        <Material name="DELRIN"/>
        <Shape type="BOX" dx="HalfTBslotWdt" dy="HalfTBslotThk" dz="HalfTBslotLen"/>
    </Volume>
    
    <!-- volumes to temperature sensor -->
    <Volume name="IBTS" comment="is the thermal Sensor">
        <Material name="Silicon" />
        <Material name="PassiveSilicon" isvol="0"/>
        <Attribute for="IBTS" seen="1" colo="2"/>
        <Shape type="BOX" dx="0.1625/2.0" dy="0.06/2.0" dz="0.1625/2.0"/>
    </Volume>

    <!-- volumes to west-side endcap -->
    <Volume name="IECW" comment="mother of the west-side endcap assembly"  >
        <Material name="PEEKCF30"  />
        <Attribute for="IECW" seen="1" colo="3"  />
        <Shape type="BOX" dx="HalfEndcapMomWdt" dy="HalfEndcapMomThk" dz="HalfEndcapMomLen"/>
        <Create    block="ICWT"/><!-- foam -->
        <Placement block="ICWT" x="0.0" y="HalfEndcapMomThk-0.0275/2.0" z="-HalfEndcapMomLen+ConnectEndcapSkinLen/2.0"/>
        <Create    block="ICWB"/><!-- foam -->
        <Placement block="ICWB" x="0.0" y="-HalfEndcapMomThk+0.0275/2.0" z="-HalfEndcapMomLen+ConnectEndcapSkinLen/2.0"/>
        <Create    block="IABW"/><!-- groove -->
        <Placement block="IABW" x="-HalfEndcapMomWdt+1.23485+0.5065/2.0" y="HalfEndcapMomThk-0.31/2.0" z="0.0"/>
        <Create    block="IAAW"/><!-- groove -->
        <Placement block="IAAW" x="-HalfEndcapMomWdt+1.23485+0.5065/2.0" y="HalfEndcapMomThk-0.31" z="0.0"/>
        <Create    block="IESB"/><!-- groove -->
        <Placement block="IESB" x="0.0" y="0.0" z="HalfEndcapMomLen-0.6-0.3/2.0"/>
        <Create    block="IESA"/><!-- groove -->
        <Placement block="IESA" x="0.0" y="0.0" z="HalfEndcapMomLen-0.6-0.3">
            <Rotation alphax="90.0"/>
        </Placement>
        <Create    block="IESC"/><!-- groove -->
        <Placement block="IESC" x="0.0" y="0.0" z="HalfEndcapMomLen-0.6">
            <Rotation alphax="90.0"/>
        </Placement>
        <Create    block="ITNW"  /><!-- groove -->
        <Placement block="ITNW"  x="-HalfEndcapMomWdt+0.55" y="0.0" z="HalfEndcapMomLen-0.5" >
            <Rotation alphax="90.0"/>
        </Placement>        
        <Create    block="ITSW"  /><!-- groove -->
        <Placement block="ITSW"  x="HalfEndcapMomWdt-0.55" y="0.0" z="HalfEndcapMomLen-0.5" >
            <Rotation alphax="90.0"/>
        </Placement>
    </Volume>
    
    <Volume name="ICWT" comment="is the cfoam endcap overlap body top BOX volume">
        <Material name="Air" />
        <Attribute for="ICWT" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfEndcapMomWdt" dy="(HalfEndcapMomThk-HalfOverlapEndcapSkinThk)/2.0" dz="ConnectEndcapSkinLen/2.0"/>
    </Volume>
    
    <Volume name="ICWB" comment="is the cfoam endcap overlap body bottom BOX volume">
        <Material name="Air" />
        <Attribute for="ICWB" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfEndcapMomWdt" dy="(HalfEndcapMomThk-HalfOverlapEndcapSkinThk)/2.0" dz="ConnectEndcapSkinLen/2.0"/>
    </Volume>
    
    <Volume name="IABW" comment="is the endcap air groove box Area for tube placement">
        <Material name="Air" />
        <Attribute for="IABW" seen="1" colo="1"/>
        <Shape type="BOX" dx="0.5065/2.0" dy="0.31/2.0" dz="HalfEndcapMomLen"/>
    </Volume>
    
    <Volume name="IAAW" comment="is the endcap air groove arc Area for tube placement">
        <Material name="Air" />
        <Attribute for="IAAW" seen="1" colo="1"/>
        <Shape type="TUBS" rmin="0" rmax="0.5065/2.0" dz="HalfEndcapMomLen" phi1="180.0" phi2="360.0" />
    </Volume>
    
    <Volume name="IESB" comment="is the endcap air groove box Area for screw thread hole">
        <Material name="Air" />
        <Attribute for="IESB" seen="1" colo="1"/>
        <Shape type="BOX" dx="0.635/2.0" dy="HalfEndcapMomThk" dz="0.3/2.0"/>
    </Volume>
    
    <Volume name="IESA" comment="is the endcap air groove arc Area for screw thread hole">
        <Material name="Air" />
        <Attribute for="IESA" seen="1" colo="1"/>
        <Shape type="TUBS" rmin="0.0" rmax="0.635/2.0" dz="HalfEndcapMomThk" phi1="180.0" phi2="360.0" />
    </Volume>
    
    <Volume name="IESC" comment="is the endcap air groove arc Area for screw thread hole">
        <Material name="Air" />
        <Attribute for="IESC" seen="1" colo="1"/>
        <Shape type="TUBS" rmin="0.0" rmax="0.635/2.0" dz="HalfEndcapMomThk" phi1=".0" phi2="180.0" />
    </Volume>
    
    <Volume name="ITNW" comment="is the endcap air groove for transport protection screw thread (northwest)">
        <Material name="Air" />
        <Attribute for="ITNW" seen="1" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.3/2.0" dz="HalfEndcapMomThk" />
    </Volume>
    
    <Volume name="ITSW" comment="is the endcap air groove for transport protection screw thread (southwest)">
        <Material name="Air" />
        <Attribute for="ITSW" seen="1" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.3/2.0" dz="HalfEndcapMomThk" />
    </Volume>
    
    <!-- volumes to east-side endcap -->
    <Volume name="IECE" comment="mother of the east-side endcap assembly"  >
        <Material name="Aluminium"  />
        <Attribute for="IECE" seen="1" colo="4"  />
        <Shape type="BOX" dx="HalfEndcapMomWdt" dy="HalfEndcapMomThk" dz="HalfEndcapMomLen"/>
	<!-- The following are all air carved out of an Al box -->
        <Create    block="ICET"/>
        <Placement block="ICET" x="0.0" y="HalfEndcapMomThk-0.03435/2.0" z="HalfEndcapMomLen-ConnectEndcapSkinLen/2.0"/>
        <Create    block="ICEB"/>
        <Placement block="ICEB" x="0.0" y="-HalfEndcapMomThk+0.03435/2.0" z="HalfEndcapMomLen-ConnectEndcapSkinLen/2.0"/>
        <Create    block="IABE"/>
        <Placement block="IABE" x="-HalfEndcapMomWdt+1.23485+0.5065/2.0" y="HalfEndcapMomThk-0.3031/2.0" z="0.0"/>
        <Create    block="IAAE"/>
        <Placement block="IAAE" x="-HalfEndcapMomWdt+1.23485+0.5065/2.0" y="HalfEndcapMomThk-0.3031" z="0.0"/>
        <Create    block="IESE"  />
        <Placement block="IESE"  x="0.0" y="0.0" z="-HalfEndcapMomLen+0.75" >
            <Rotation alphax="90.0"/>
        </Placement>
        <Create    block="IESS"  />
            <Placement block="IESS"  x="HalfEndcapMomWdt-1.8" y="0.0" z="-HalfEndcapMomLen+0.5" >
            <Rotation alphax="90.0"/>
        </Placement>
        <Create    block="ITNE"  />
        <Placement block="ITNE"  x="-HalfEndcapMomWdt+0.55" y="0.0" z="-HalfEndcapMomLen+0.5" >
            <Rotation alphax="90.0"/>
        </Placement>
        <Create    block="ITSE"  />
        <Placement block="ITSE"  x="HalfEndcapMomWdt-0.55" y="0.0" z="-HalfEndcapMomLen+0.5" >
            <Rotation alphax="90.0"/>
        </Placement>
    </Volume>
    
    <Volume name="ICET" comment="is the Aluminium endcap overlap body top BOX volume">
        <Material name="Air" />
        <Attribute for="ICET" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfEndcapMomWdt" dy="0.03435/2.0" dz="ConnectEndcapSkinLen/2.0"/>
    </Volume>
    
    <Volume name="ICEB" comment="is the Aluminium endcap overlap body bottom BOX volume">
        <Material name="Air" />
        <Attribute for="ICEB" seen="1" colo="1"/>
        <Shape type="BOX" dx="HalfEndcapMomWdt" dy="0.03435/2.0" dz="ConnectEndcapSkinLen/2.0"/>
    </Volume>
    
    <Volume name="IABE" comment="is the endcap air groove box Area for tube placement">
        <Material name="Air" />
        <Attribute for="IABE" seen="1" colo="1"/>
        <Shape type="BOX" dx="0.5065/2.0" dy="0.3031/2.0" dz="HalfEndcapMomLen"/>
    </Volume>
    
    <Volume name="IAAE" comment="is the endcap air groove arc Area for tube placement">
        <Material name="Air" />
        <Attribute for="IAAE" seen="1" colo="1"/>
        <Shape type="TUBS" rmin="0" rmax="0.5065/2.0" dz="HalfEndcapMomLen" phi1="180.0" phi2="360.0" />
    </Volume>
    
    <Volume name="IESE" comment="is the screw thread air hole TUBE volume in east-side endcap">
        <Material name="Air" />
        <Attribute for="IESE" seen="1" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.635/2.0" dz="HalfEndcapMomThk" />
    </Volume>

    <Volume name="IESS" comment="is the small thread air hole TUBE volume in east-side endcap">
        <Material name="Air" />
        <Attribute for="IESS" seen="1" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.205/2.0" dz="HalfEndcapMomThk" />
    </Volume>
    
    <Volume name="ITNE" comment="is the endcap air groove for transport protection screw thread (northeast)">
        <Material name="Air" />
        <Attribute for="ITNE" seen="1" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.3/2.0" dz="HalfEndcapMomThk" />
    </Volume>
    
    <Volume name="ITSE" comment="is the endcap air groove for transport protection screw thread (southeast)">
        <Material name="Air" />
        <Attribute for="ITSE" seen="1" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.3/2.0" dz="HalfEndcapMomThk" />
    </Volume>
   
    <!-- NOTE: can be reduced to a polycone -->

    <!-- volumes to screws and washers -->
    <Volume name="ISCM" comment="mother of the screw assembly"  >
        <Material name="Air"  />
        <Attribute for="ISCM" seen="0" colo="1"  />
        <Shape type="BOX" dx="0.5*1.25" dy="0.5*1.651" dz="0.5*1.25"/>
        <Create block="ISCH"/>
        <Placement block="ISCH" x="0.0" y="0.5*1.651-0.5*0.381" z="0.0">
            <Rotation alphax="90.0"/>
        </Placement>
        <Create block="ISCS"/>
        <Placement block="ISCS" x="0.0" y="0.5*1.651-0.381-0.5*0.635" z="0.0">
            <Rotation alphax="90.0"/>
        </Placement>
        <Create block="ISCR"/>
        <Placement block="ISCR" x="0.0" y="-0.5*1.651+0.5*0.635" z="0.0">
            <Rotation alphax="90.0"/>
        </Placement>
        <Create block="ISWS"/>
        <Placement block="ISWS" x="0.0" y="0.5*1.651-0.381-0.5*0.16" z="0.0">
            <Rotation alphax="90.0"/>
        </Placement>
    </Volume>
    
    <Volume name="ISCH" comment="is the screw hat">
        <Material name="Aluminium" />
        <Attribute for="ISCH" seen="1" colo="4"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.5*1.1" dz="0.5*0.381" />
    </Volume>

    <Volume name="ISCS" comment="is the screw middle cylinder stude">
        <Material name="Aluminium" />
        <Attribute for="ISCS" seen="1" colo="4"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.5*0.635" dz="0.5*0.635" />
    </Volume>    

    <Volume name="ISCR" comment="is the screw stud">
        <Material name="Aluminium" />
        <Attribute for="ISCR" seen="1" colo="4"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.5*0.3928" dz="0.5*0.635" />
    </Volume>
    
    <Volume name="ISWS" comment="is the screw washer">
        <Material name="Aluminium" />
        <Attribute for="ISWS" seen="1" colo="4"/>
        <Shape type="TUBE" rmin="0.5*0.64" rmax="0.5*1.25" dz="0.5*0.16" />
    </Volume>
    
    <!-- volumes to support ring structure -->
    <Volume name="IBSR" comment="is the support structure mother volume">
        <Material name="Air" />
        <Attribute for="IBSR" seen="0" colo="1"/>
        <Shape type="BOX" dx="HalfSRMomWdt" dy="HalfSRMomThk" dz="HalfSRMomLen" />
        <Create    block="ISRR"/>
        <Placement block="ISRR" x="HalfSRMomWdt-0.15-0.5*0.207" y="HalfSRMomThk-0.7148-0.3-0.5*1.3553" z="-HalfSRMomLen+0.5*0.9525"/>
        <Create    block="ISRB"/> <!-- IRBA is a hole w/in ISRB -->
        <Placement block="ISRB" konly="MANY"
		   x="0.0" y="HalfSRMomThk-0.7148-0.5*0.3" 
		   z="-HalfSRMomLen+0.5*0.9525"/>
        <Create    block="IRBA"/> <!-- Hole in ISRB -->
        <Placement block="IRBA" 
		   x="HalfSRMomWdt-0.15-0.5*0.3" 
		   y="HalfSRMomThk-0.7148" 
		   z="-HalfSRMomLen+0.5*0.9525"/>
        <Create    block="ISRL"/> <!-- Air hole ISRH -->
        <Placement block="ISRL" konly="MANY"
		   x="-HalfSRMomWdt+0.5*0.7452+0.23755" 
		   y="HalfSRMomThk-0.7148-0.3-0.1105-0.88655" 
		   z="-HalfSRMomLen+0.5*0.9525">
          <Rotation alphaz="-75.0"/>
        </Placement> 
        <Create block="ISRC"/>
        <Placement block="ISRC" x="-HalfSRMomWdt+0.3652" y="HalfSRMomThk-0.7148-0.3-0.5*0.1105" z="-HalfSRMomLen+0.5*0.9525"/>
        <Create block="ISRA"/>
        <Placement block="ISRA" x="HalfSRMomWdt-0.15+0.0882*ModuleInnerRadius" y="HalfSRMomThk-0.7148-0.3-1.3553-0.153-0.9961*ModuleInnerRadius" z="0.0">
	</Placement>
        <Create block="ISRO"/>
        <Placement block="ISRO" x="HalfSRMomWdt-0.5*0.15" y="HalfSRMomThk-0.5*0.7148" z="-HalfSRMomLen+0.5*0.9525"/>
        <Create block="IROA"/>
        <Placement block="IROA" x="HalfSRMomWdt-0.15" y="HalfSRMomThk-0.1-0.5*0.2" z="-HalfSRMomLen+0.5*0.9525">
        <Rotation alphaz="90.0"/>
        </Placement>
        <Create    block="ISRS"/>
        <Placement block="ISRS" x="HalfSRMomWdt-0.15-0.5*0.3116" y="HalfSRMomThk-0.5*0.1" z="-HalfSRMomLen+0.5*0.9525"/>
        <Create    block="ISRH"/>
        <Placement block="ISRH" x="-HalfSRMomWdt+0.3572" y="HalfSRMomThk-0.7148-0.5*1.2438" z="-HalfSRMomLen+0.47625">
          <Rotation alphax="90.0"/>
        </Placement>
    </Volume>
    
    <Volume name="ISRR" comment="is the support ring structure box sub-volume south side">
        <Material name="PEEKCF30" />
        <Attribute for="ISRR" seen="1" colo="3"/>
        <Shape type="BOX" dx="0.5*0.207" dy="0.5*1.3553" dz="0.5*0.9525"/>
    </Volume>
    
    <Volume name="ISRB" comment="is the support ring structure box sub-volume top side">
        <Material name="PEEKCF30" />
        <Attribute for="ISRB" seen="1" colo="3"/>
	<Shape type="BOX" dx="0.5*3.5575" dy="0.5*0.3" dz="0.5*0.9525"/>
    </Volume>

    <Volume name="IRBA" comment="is the support ring structure air groove">
        <Material name="Air" />
        <Attribute for="ISRA" seen="1" colo="3"/>
        <Shape type="TUBS" rmin="0" rmax="0.15" dz="0.5*0.9525" phi1="180.0" phi2="360.0"/>
    </Volume>
    
    <Volume name="ISRL" comment="is the support ring structure trapezoid sub-volume north side">
        <Material name="PEEKCF30" />
        <Attribute for="ISRL" seen="1" colo="3"/>
        <Shape type="TRAP" dz="0.5*0.9525"   thet="0" phi="0"
                h1="0.5*0.7198"        h2="0.5*0.7198"
                bl1="0.5*1.9321"       bl2="0.5*1.9321"
                tl1="0.5*1.7392"       tl2="0.5*1.7392"
                alp1="7.63192"         alp2="7.63192" />
    </Volume>
    
    <Volume name="ISRC" comment="is the support ring structure connect Area">
        <Material name="PEEKCF30" />
        <Attribute for="ISRC" seen="1" colo="3"/>
        <Shape type="TRAP" dz="0.5*0.9525"   thet="0" phi="0"
                h1="0.5*0.1105"       h2="0.5*0.1105"
                bl1="0.5*0.7452"      bl2="0.5*0.7452"
                tl1="0.5*0.7156"      tl2="0.5*0.7156"
                alp1="-7.6286"        alp2="-7.6286" />
    </Volume>
   
    <Volume name="ISRA" comment="is the support ring structure arc Area">
        <Material name="PEEKCF30" />
        <Attribute for="ISRA" seen="1" colo="3"/>
        <Shape type="TUBS" rmin="0.5*23.8506" rmax="0.5*24.1506" dz="0.5*1.27" phi1="90.0+5.06" phi2="104.129+5.06"/>
    </Volume>
 
    <Volume name="ISRO" comment="is the support ring structure top edge">
        <Material name="PEEKCF30" />
        <Attribute for="ISRO" seen="1" colo="3"/>
        <Shape type="BOX" dx="0.5*0.15" dy="0.5*0.7148" dz="0.5*0.9525"/>
    </Volume>

    <Volume name="IROA" comment="is the support ring structure air groove in ISRO">
        <Material name="PEEKCF30" />
        <Attribute for="IROA" seen="1" colo="3"/>
        <Shape type="TUBS" rmin="0.0" rmax="0.1" dz="0.5*0.9525" phi1="180.0" phi2="360.0"/>
    </Volume>
    
    <Volume name="ISRS" comment="is the support small box sub-volume top side">
        <Material name="PEEKCF30" />
        <Attribute for="ISRS" seen="1" colo="3"/>
	<Shape type="BOX" dx="0.5*0.3116" dy="0.5*0.1" dz="0.5*0.9525"/>
    </Volume>

    <Volume name="ISRH" comment="is the air hole for screwing stave ">
        <Material  name="Air" />
        <Attribute for="ISRH" seen="0" colo="1"/>
        <Shape type="TUBE" rmin="0.0" rmax="0.5*0.3454" dz="0.5*1.2438" />
    </Volume>
 
    <!-- volumes to silicon sensors and APV chips -->
    <Volume name="IBLM" comment="mother of the sensor assembly"  >
       <Material name="Air"  />
       <Attribute for="IBLM" seen="0" colo="1"  />
       <Shape type="BOX" dx="HalfSenMomWdt" dy="HalfSenMomThk" dz="HalfSenMomLen"/>
       <Create block="IBSS"/>
       <Placement block="IBSS" x="HalfSenMomWdt-HalfSensorWdt-2*HalfSensorEdgeT" y="0.0" z="0.0">
       <Rotation alphaz="180"/>
       </Placement>
       <Create block="IBTE"/>
       <Placement block="IBTE" x="HalfSenMomWdt-HalfSensorEdgeT" y="0.0" z="0.0">
       </Placement>
       <Create block="IBBE"/>
       <Placement block="IBBE" x="2*HalfAPVWdt+APVSensorGapSize+HalfSensorEdgeB-HalfSenMomWdt" y="0.0" z="0.0">
       </Placement>
       <Create block="IBLE"/>
       <!-- the number 2.0 means width of silicon sensor (sensitive + passive) -->
       <Placement block="IBLE" x="HalfSenMomWdt-2.0" y="0.0" z="HalfSenMomLen-HalfSensorEdgeLR-0.5*SensorGapSize">
       </Placement>
       <Create block="IBRE"/>
       <Placement block="IBRE" x="HalfSenMomWdt-2.0" y="0.0" z="HalfSensorEdgeLR+0.5*SensorGapSize-HalfSenMomLen">
       </Placement>
       <!-- placement for APVs   -->
       <Do var="num" from="1" to="nAPVUnit">
           <Create block="IBAP"/>
           <Placement in="IBLM" x="-HalfSenMomWdt+HalfAPVWdt" y="0.0" z="-HalfSenMomLen+HalfAPVLen*(2*num-1)+APVGapSize*(num-1)+0.36875" block="IBAP">
           </Placement>
       </Do>     
    </Volume>
    
 <Volume name="IBTE" comment="is the Silicon Sensor top dead Area">
     <Material name="Silicon" /> 
     <Material name="PassiveSilicon" isvol="0"/>
     <Attribute for="IBTE" seen="1" colo="2"/>
     <Shape type="BOX" dx="HalfSensorEdgeT" dy="HalfSensorThk" dz="HalfSensorLen"/>
 </Volume>
    
 <Volume name="IBBE" comment="is the Silicon Sensor bottom dead Area">
    <Material name="Silicon" />
    <Material name="PassiveSilicon" isvol="0"/>
    <Attribute for="IBBE" seen="1" colo="2"/>
    <Shape type="BOX" dx="HalfSensorEdgeB" dy="HalfSensorThk" dz="HalfSensorLen"/>
 </Volume>
    
    <Volume name="IBLE" comment="is the Silicon Sensor left dead Area">
        <Material name="Silicon" />
        <Material name="PassiveSilicon" isvol="0"/>
        <Attribute for="IBLE" seen="1" colo="2"/>
        <Shape type="BOX" dx="2.0" dy="HalfSensorThk" dz="HalfSensorEdgeLR"/>
    </Volume>

    <Volume name="IBRE" comment="is the Silicon Sensor right dead Area">
        <Material name="Silicon" />
        <Material name="PassiveSilicon" isvol="0"/>
        <Attribute for="IBRE" seen="1" colo="2"/>
        <Shape type="BOX" dx="2.0" dy="HalfSensorThk" dz="HalfSensorEdgeLR"/>
    </Volume>
    
    <Volume name="IBAP" comment="is the APV chip">
        <Material name="APVMix" />
        <!-- <Material name="PassiveSilicon" isvol="0"/> -->
        <Attribute for="IBAP" seen="1" colo="2"/>
        <Shape type="BOX" dx="HalfAPVWdt" dy="HalfAPVThk" dz="HalfAPVLen"/>
    </Volume>

 <Volume name="IBSS" comment="is the Silicon Sensor Active Area">
       <Material name="Silicon"  />
       <Material name="ISTSSensitive" isvol="1"/>
       <Attribute for="IBSS" seen="1" colo="2"/>
       <Shape type="BOX" dx="HalfSensorWdt" dy="HalfSensorThk" dz="HalfSensorLen"/>
       <Instrument block="IBSS"  >
                <Hit meas="z" opts="S" bins=".001"  />
                <Hit meas="y" bins=".001"  />
                <Hit meas="x" bins=".001"  />
                <Hit meas="ptot" nbits="16" min="0" max="100"  />
                <Hit meas="cx" nbits="10"  />
                <Hit meas="cy" nbits="10"  />
                <Hit meas="cz" nbits="10"  />
                <Hit meas="sleng" nbits="16" min="0" max="500"  />
                <Hit meas="tof" nbits="16"  />
                <Hit meas="step" bins=".01"  />
                <Hit meas="eloss" nbits="16"  />
        </Instrument>
 </Volume>

 
 <!-- ICCT volume for simply cables/cooling lines description in transition area -->

 <Volume name="ICCT" comment="average volume of average cables/cooling line in transition area">
  <Material name="CuAlNovecMix"/>
  <Attribute for="ICCT" seen="1" colo="629"/>
  <Shape type="CONE" rmn1="24.068" rmx1="24.8745" rmn2="14.7727" rmx2="17.4338" dz="0.5*8.7144" />
 </Volume>


 <!-- volumes definitions for purples cables and cooling line on PIT -->
 <Volume name="ICCA" comment="IST purple cable A on PIT">
  <Material name="copper" />
  <Attribute for="ICCA" seen="1" colo="629"/>
  <Shape type="TUBE" rmin="0" rmax="0.5*cableDiameter" dz="0.5*170.18"/>
 </Volume>


 <Volume name="ICCL" comment="IST cooling line on PIT">
   <Material name="Aluminium" />
   <Attribute for="ICCL" seen="1" colo="4"/>
   <Shape type="TUBE" rmin="0.5*0.5334" rmax="0.5*0.635" dz="0.5*170.18"/>
 </Volume>

 <Volume name="ICLP" comment="cooling liquid in ICCL volume on PIT area">
 <Attribute for="ICLP" seen="1" colo="920"/>
 <Material name="NOVEC7200"/>
 <Shape type="TUBE" rmin="0" rmax="0.5*0.5334" dz="0.5*170.18" />
 </Volume>

</Module>

<Subroutine name="trans_to_ibam" 
	    args="['x', 'y','tilt', 'xpos', 'ypos']" >
  <Arguement type="real" intent="in" name="x" />
  <Arguement type="real" intent="in" name="y" />
  <Arguement type="real" intent="in" name="tilt" />
  <Arguement type="real" intent="inout" name="xpos" />
  <Arguement type="real" intent="inout" name="ypos" />

  <varlist type="double" >
    sint, cost, degrad
    radius/13.9254/
  </varlist>
  degrad=3.1415926/180.0
  sint=sin(degrad*tilt)
  cost=cos(degrad*tilt)
  xpos = 0.0       +  cost*x +sint*y
  ypos = radius    -  sint*x +cost*y
  return
</Subroutine>
    
</Document>
