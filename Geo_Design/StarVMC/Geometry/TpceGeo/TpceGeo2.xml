
<Document file="StarVMC/Geometry/TpceGeo/TpceGeo2.xml"  >

    <Module name="TPCEGEO2" comment="  is the updated TPC "  >
        <Author name="David Underwood corrected by Maxim Potekhin"  />
        <Created date="  Dec 7, 2005 "  />
        <CDE  >
            AGECOM
            GCUNIT
            GCONST
        </CDE>
        
        <Content  >
            TPCE,TOFC,TOFS,TOST,TOKA,TONX,TOAD,TOHA,TPGV,TPSS,
            TIFC,TIAL,TIKA,TINX,TPCW,TWSS,TWGI,TPCM,TPEA,TESS,
            TSEC,TMWC,TMEA,TMSE,TIAG,TOAE,TPAD,THOL,THRA,THLA,
            TALC,TAEC,TCEX,TCRX,TWGC,TWGB,TPIP,TMAN,TRDV,TRDS,
            TRDC
        </Content>
        
        <Structure name="TPCG"  >
            <var name="version" type="float"  />
            <var name="rmin" type="float"  />
            <var name="rmax" type="float"  />
            <var name="length" type="float"  />
            <var name="WheelIR" type="float"  />
            <var name="WheelOR" type="float"  />
            <var name="WheelTHK" type="float"  />
            <var name="SenGasOR" type="float"  />
            <var name="tpeaTHK" type="float"  />
            <var name="MembTHK" type="float"  />
            <var name="tiadDR" type="float"  />
            <var name="tinxDR" type="float"  />
            <var name="tikaDR" type="float"  />
            <var name="tialDR" type="float"  />
            <var name="tocsDR" type="float"  />
            <var name="tokaDR" type="float"  />
            <var name="tonxDR" type="float"  />
            <var name="toadDR" type="float"  />
            <var name="toigDR" type="float"  />
            <var name="toalDR" type="float"  />
            <var name="tohaDR" type="float"  />
            <var name="MWCread" type="float"  />
            <var name="gasCorr" type="float"  />
        </Structure>
        
        <Structure name="TECW"  >
            <var name="sec" type="float"  />
            <var name="GapRad" type="float"  />
            <var name="GapHeit" type="float"  />
            <var name="GapWidI" type="float"  />
            <var name="GapWidO" type="float"  />
            <var name="GapShft" type="float"  />
            <var name="inwidth" type="float"  />
            <var name="ouwidth" type="float"  />
            <var name="height" type="float"  />
            <var name="ppdepth" type="float"  />
            <var name="asdepth" type="float"  />
            <var name="ggdepth" type="float"  />
            <var name="MWCdepth" type="float"  />
            <var name="boundary" type="float"  />
            <var name="Rcenter" type="float"  />
            <var name="MWCinn" type="float"  />
            <var name="MWCout" type="float"  />
            <var name="MWChei" type="float"  />
            <var name="MwcCent" type="float"  />
            <var name="MwcNwir" type="float"  />

            <var name="n" type="float"  />
            <var name="nex" type="float"  />
            <var name="z(8)" type="float"  />
            <var name="dz(8)" type="float"  />
            <var name="xex(5)" type="float"  />
            <var name="zex(5)" type="float"  />
            <var name="dxex(5)" type="float"  />
            <var name="dzex(5)" type="float"  />
            <var name="nhplane(8)" type="float"  />
            <var name="cardw" type="float"  />
            <var name="cardth" type="float"  />
            <var name="coolw" type="float"  />
            <var name="coolth" type="float"  />
            <var name="cardoff" type="float"  />
            <var name="cooloff" type="float"  />
            <var name="slotw" type="float"  />
            <var name="slotrad" type="float"  />
            <var name="pipethk" type="float"  />
            <var name="pipeht" type="float"  />
            <var name="manithk" type="float"  />
            <var name="maniwid" type="float"  />
            <var name="tan15" type="float"  />
            <var name="clearance" type="float"  />
            <var name="Whlipthk" type="float"  />
            <var name="Whlipwid" type="float"  />
            <var name="Whblklen" type="float"  />
            <var name="Whblkpos" type="float"  />
            <var name="Whblkin" type="float"  />
        </Structure>
        

        <Structure name="TROV"  >
            <var name="sec" type="float"  />
            <var name="nhp(16)" type="float"  />
            <var name="hx(9,16)" type="float"  />
            <var name="offCrdIo" type="float"  />
        </Structure>
        
        <Structure name="TPRS"  >
            <var name="sec" type="float"  />
            <var name="Nrow" type="float"  />
            <var name="pitch" type="float"  />
            <var name="width" type="float"  />
            <var name="super" type="float"  />
            <var name="Rpads(40)" type="float"  />
            <var name="Npads(40)" type="float"  />
        </Structure>
        
        <Structure name="TRDO"  >
            <var name="RdoVthk" type="float"  />
            <var name="Rdothk" type="float"  />
            <var name="Rdolen" type="float"  />
            <var name="NRdobrd" type="float"  />
            <var name="Rdoht(9)" type="float"  />
        </Structure>
        

        <varlist type="REAL"  >
            tocsIR,tocsOR,tokaIR,tokaOR,tonxIR,tonxOR,toadIR,toadOR,toigIR,toigOR,toalIR,toalOR,tohaIR,tohaOR,tofsIR,tofsOR,tofcIR,tofcOR,tiadIR,tiadOR,tinxIR,tinxOR,tikaIR,tikaOR,tialIR,tialOR,tifcIR,tifcOR,tpgvIR,tpgvLeng,tofcLeng,tpcwz,tpgvz,tpeaZ,tprdoz,dx_dz,dxb,del,a,b,radoff,zvalue
        </varlist>
        
        <varlist type="REAL"  >
            pipeoff
        </varlist>
        
        <varlist type="REAL"  >
            ztemp,xtemp,hpla,xbottom
        </varlist>
        
        <varlist type="REAL"  >
            mntcylid,mntcylod,mntcylht,xlip
        </varlist>
        
        <varlist type="REAL"  >
            T,P,PATM,RHO,density
        </varlist>
        

        <varlist type="INTEGER"  >
            i_row,i_sec,i,jj,kk,i_nhp,j_nho
        </varlist>

<Export language="Mortran">        
        <External routine="TPADSTEP"  />
        <External routine="TPAISTEP"  />
        <External routine="TPAOSTEP"  />
        <External routine="TPCELASER"  />
</Export>

        <Fill name="TPCG" comment="TPC basic dimensions"  >
            <var name="version" value="2" comment=" current version "  />
            <var name="rmin" value="46.107" comment=" TPC inner radius  "  />
            <var name="rmax" value="207.750" comment=" TPC outer radius "  />
            <var name="length" value="519.37" comment=" TPC full length "  />
            <var name="WheelIR" value="49.60" comment=" support wheel inner radius "  />
            <var name="WheelOR" value="206.75" comment=" support wheel outer radius "  />
            <var name="WheelTHK" value="11.43" comment=" support wheel length "  />
            <var name="SenGasOR" value="200" comment=" TPC sensitive gas outer radius "  />
            <var name="tpeaTHK" value="9.7" comment=" endcap MWC + sector thickness "  />
            <var name="MembTHK" value=".00762" comment=" Central membrane thickness "  />
            <var name="tocsDR" value=".013" comment=" outer copper thickness "  />
            <var name="tokaDR" value=".015" comment=" outer kapton thickness "  />
            <var name="tonxDR" value="1.00" comment=" outer nomex thickness "  />
            <var name="toadDR" value="0.02" comment=" outer adhesive thickness "  />
            <var name="toigDR" value="5.70" comment=" outer isolating gas thickness "  />
            <var name="toalDR" value="0.40" comment=" outer aluminum thickness "  />
            <var name="tohaDR" value="0.60" comment=" outer HoneyUcomb Al thickness   "  />
            <var name="tiadDR" value="0.080" comment=" inner adhesive layer thickness "  />
            <var name="tinxDR" value="1.270" comment=" inner nomex structure thickness "  />
            <var name="tikaDR" value="0.015" comment=" inner Kapton layer thickness "  />
            <var name="tialDR" value="0.004" comment=" inner aluminum layer thickness "  />
            <var name="MWCread" value="2" comment=" MWC readout flag "  />
            <var name="gasCorr" value="1" comment=" gas density correction version "  />
        </Fill>
        
        <Fill name="TRDO" comment="volume for tpc readout boards"  >
            <var name="RdoVthk" value="30." comment=" length of RDO vloume "  />
            <var name="Rdothk" value=".25" comment=" thickness of rdo card "  />
            <var name="Rdolen" value="27" comment=" card length along beam direction "  />
            <var name="NRdobrd" value="9" comment=" number of RDO boards "  />
            <var name="Rdoht" value="{60.0,74.0,84.0,101.0,106.0,126.0,146.0,166.0,186.0}" comment=" radial pos of rdo boards "  />
        </Fill>
        
        <Fill name="TPRS" comment="sector of padrows"  >
            <var name="sec" value="1" comment=" sector number: 1 for inner, 2 for outer "  />
            <var name="nRow" value="13" comment=" number of padrows in the sector "  />
            <var name="pitch" value="0.335" comment=" tpc padrow pitch width "  />
            <var name="width" value="1.15" comment=" tpc padrow thickness "  />
            <var name="super" value="3" comment=" number of padraws in a superpadrow "  />
            <var name="Npads" value="{88,96,104,112,118,126,134,142,150,158,166,174,182 }" comment=" number of pads in row "  />
            <var name="Rpads" value="{60.0,64.8,69.6,74.4,79.2,84.0,88.8,93.6,98.8,104.0,109.2,114.4,119.6 }" comment=" tpc padrow radii "  />
        </Fill>
        
        <Fill name="TPRS" comment="sector of padrows"  >
            <var name="sec" value="2" comment=" sector number: 1 for inner, 2 for outer "  />
            <var name="nRow" value="32" comment=" number of padrows in outer sector "  />
            <var name="pitch" value="0.67" comment=" outer tpc padrow pitch width "  />
            <var name="width" value="1.95" comment=" outer tpc padrow thickness "  />
            <var name="super" value="1" comment=" number of padrows in a superpadrow "  />
            <var name="Npads" value="{98,100,102,104,106,106,108,110,112,112,114,116,118,120,122,122,124,126,128,128,130,132,134,136,138,138,140,142,144,144,144,144 }" comment=" number of pads in row "  />
            <var name="Rpads" value="{127.195,129.195,131.195,133.195,135.195,137.195,139.195,141.195,143.195,145.195,147.195,149.195,151.195,153.195,155.195,157.195,159.195,161.195,163.195,165.195,167.195,169.195,171.195,173.195,175.195,177.195,179.195,181.195,183.195,185.195,187.195,189.195 }" comment=" tpc padrow radii "  />
        </Fill>
        
        <Fill name="TECW" comment="EC trapezoid and support Wheel"  >
            <var name="sec" value="1" comment=" sector number: 1 for inner, 2 for outer "  />
            <var name="GapWidI" value="2.* 10.91" comment=" air in support wheel - inner width "  />
            <var name="GapWidO" value="2.* 27.56" comment=" air in support wheel - outer width "  />
            <var name="GapHeit" value="62.15" comment=" air in support wheel - height (dr) "  />
            <var name="GapRad" value="87.0" comment=" air in support wheel - center radius "  />
            <var name="GapShft" value="1.4" comment=" offset air gap to make lip "  />
            <var name="inwidth" value="2.* 13.75" comment=" sector width at inner radius  "  />
            <var name="ouwidth" value="2.* 32.38" comment=" sector width at outer radius "  />
            <var name="height" value="69.52" comment=" sector radial height "  />
            <var name="ppdepth" value="1.35+0.32" comment=" padplane thickness (both Al and PCB) "  />
            <var name="asdepth" value="6.99" comment=" depth of openings in aluminum structure "  />
            <var name="ggdepth" value="1.0" comment=" MWC gap from gated grid to pad plane "  />
            <var name="MWCdepth" value="1.0" comment=" sensitive MWC gas gap full thickness "  />
            <var name="boundary" value="3.74" comment=" al frame - boundary width "  />
            <var name="Rcenter" value="86.669" comment=" sector center radius (set by precision holes) "  />
            <var name="MwcInn" value="2*12.804" comment=" MWC sensitive region inner size "  />
            <var name="MwcOut" value="2*29.953" comment=" MWC sensitive region outer size "  />
            <var name="MwcHei" value="64" comment=" MWC sensitive region height (radial) "  />
            <var name="MwcCent" value="-1.669" comment=" sensitive region center position "  />
            <var name="MwcNwir" value="160" comment=" number of MWC sensitive wires "  />
            <var name="n" value="5" comment=" number of air gaps in Al "  />
            <var name="nex" value="0" comment=" number of extra aluminum support pieces "  />
            <var name="z" value="{6.67,18.22,34.22,50.22,62.65 }" comment=" positions of air gaps "  />
            <var name="dz" value="{6.13,15.05,15.05,15.05,7.09 }" comment=" size of air gaps "  />
            <var name="xex" value="{0,0,0,0,0 }" comment=" x positions of extra aluminum "  />
            <var name="zex" value="{0,0,0,0,0 }" comment=" z positions of extra aluminum "  />
            <var name="dxex" value="{0,0,0,0,0 }" comment=" x-thickness of extra aluminum "  />
            <var name="dzex" value="{0,0,0,0,0 }" comment=" z-thickness of extra aluminum "  />
            <var name="nhplane" value="{1,4,4,4,2}" comment=" number of PC planes per air gap "  />
            <var name="Whlipthk" value="1.0" comment=" wheel bolt lip along beam "  />
            <var name="Whlipwid" value="2.8" comment=" wheel lip in phi "  />
            <var name="Whblklen" value="5.5" comment=" blocks on wheel radial size "  />
            <var name="Whblkpos" value="18.0" comment=" bolt blocks at +- 18 in whl "  />
            <var name="Whblkin" value="0" comment=" no block bottom inner wheel "  />
            <var name="cardw" value="7.33" comment=" PC card width and thickness  "  />
            <var name="cardth" value="0.19" comment=" PC card width and thickness  "  />
            <var name="coolw" value="5.7" comment=" cooling AL width and thickness "  />
            <var name="coolth" value="0.33" comment=" cooling AL width and thickness "  />
            <var name="cardoff" value="1.77" comment=" card and cooling offsets from "  />
            <var name="cooloff" value="1.50" comment=" card and cooling offsets from "  />
            <var name="slotw" value="4.70" comment=" slot width and radius "  />
            <var name="slotrad" value="0.95" comment=" slot width and radius "  />
            <var name="pipethk" value="1.26" comment=" water pipe along beam dir "  />
            <var name="pipeht" value="1.9" comment=" water pipe radial "  />
            <var name="manithk" value="4.5" comment=" water manifold along beam "  />
            <var name="maniwid" value="2.2" comment=" water manifold in phi "  />
            <var name="tan15" value=".26795" comment=" tangent of 15 deg "  />
            <var name="clearance" value="1.0" comment=" clearance for RDO boardsin phi "  />
        </Fill>
        
        <Fill name="TECW" comment="endcap trapezoid and support Wheel"  >
            <var name="sec" value="2" comment=" sector number: 1 for inner, 2 for outer "  />
            <var name="GapWidI" value="2.* 28.92" comment=" air in support wheel - inner width "  />
            <var name="GapWidO" value="2.* 46.74" comment=" air in support wheel - outer width "  />
            <var name="GapHeit" value="65.0" comment=" air in support wheel - height (dr) "  />
            <var name="GapRad" value="158.0" comment=" air in support wheel - radius "  />
            <var name="GapShft" value="0.0" comment=" offset of air gap lip "  />
            <var name="inwidth" value="64.92" comment=" sector width at inner radius  "  />
            <var name="ouwidth" value="103.25" comment=" sector width at outer radius  "  />
            <var name="height" value="71.51" comment=" sector radial height "  />
            <var name="ppdepth" value="0.95+0.32" comment=" padplane thickness (both Al and PCB) "  />
            <var name="asdepth" value="6.99" comment=" depth of openings in aluminum structure "  />
            <var name="ggdepth" value="1.4" comment=" MWC gap from gated grid to pad plane "  />
            <var name="MWCdepth" value="1.4" comment=" sensitive MWC gas gap full thickness "  />
            <var name="boundary" value="3.74" comment=" al frame - boundary width "  />
            <var name="Rcenter" value="157.488" comment=" sector center radius (set by precision holes) "  />
            <var name="MwcInn" value="2*32.202" comment=" MWC sensitive region inner size "  />
            <var name="MwcOut" value="2*49.351" comment=" MWC sensitive region outer size "  />
            <var name="MwcHei" value="64" comment=" MWC sensitive region height (radial) "  />
            <var name="MwcCent" value="-0.093" comment=" sensitive region center position "  />
            <var name="MwcNwir" value="160" comment=" number of MWC sensitive wires "  />
            <var name="n" value="8" comment=" number of air gaps in Al "  />
            <var name="nex" value="5" comment=" number of extra aluminum support pieces "  />
            <var name="z" value="{8.216,16.217,24.218,32.219,40.220,48.221,56.222,64.143    }" comment=" opening positions "  />
            <var name="dz" value="{7.05,7.05,7.05,7.05,7.05,7.05,7.05,6.89     }" comment=" opening size  "  />
            <var name="xex" value="{0.,0.,0.,-21.907,21.907      }" comment=" x positions "  />
            <var name="zex" value="{6.69,32.22,40.22,56.22,56.22 }" comment=" z positions "  />
            <var name="dxex" value="{2.54,0.476,0.476,3.175,3.175 }" comment=" x-thickness "  />
            <var name="dzex" value="{4.00,7.05,7.05,7.05,7.05  }" comment=" z-thickness "  />
            <var name="nhplane" value="{2,2,2,2,2,2,2,2}" comment=" number of PC planes per air gap "  />
            <var name="Whlipthk" value="1.0" comment=" wheel bolt lip along beam "  />
            <var name="Whlipwid" value="2.8" comment=" wheel lip in phi "  />
            <var name="Whblklen" value="5.5" comment=" blocks on wheel radial size "  />
            <var name="Whblkpos" value="18.0" comment=" bolt blocks at +- 18 in whl "  />
            <var name="Whblkin" value="1" comment=" is block bottom outer wheel "  />
            <var name="cardw" value="7.33" comment=" PC card width and thickness  "  />
            <var name="cardth" value="0.19" comment=" PC card width and thickness  "  />
            <var name="coolw" value="5.7" comment=" cooling AL width and thickness "  />
            <var name="coolth" value="0.33" comment=" cooling AL width and thickness "  />
            <var name="cardoff" value="1.77" comment=" card and cooling offsets from "  />
            <var name="cooloff" value="1.50" comment=" card and cooling offsets from "  />
            <var name="slotw" value="4.70" comment=" slot width and radius "  />
            <var name="slotrad" value="0.95" comment=" slot width and radius "  />
            <var name="pipethk" value="1.26" comment=" water pipe along beam dir "  />
            <var name="pipeht" value="1.9" comment=" water pipe radial "  />
            <var name="manithk" value="4.5" comment=" water manifold along beam "  />
            <var name="maniwid" value="2.2" comment=" water manifold in phi "  />
            <var name="tan15" value=".26795" comment=" tangent of 15 deg "  />
            <var name="clearance" value="1.0" comment=" clearance for RDO boardsin phi "  />
        </Fill>
        

        <Fill name="TROV" comment="cards in row 1"  >
            <var name="sec" value="1" comment="  inner "  />
            <var name="nhp" value="{0,2,2,3,3,3,3,4,4,4,4,5,2,5,5,6}" comment="no of holes/plane "  />

            <!-- Original AgSTAR file.  Note the misplaced ";" after the 4th entry
            <var name="hx" value="{  0.0,   0.0,    0.0,   0.0;    0.0,   0.0, 0.0, 0.0, 0.0,            
                                    -5.17,  5.17,   0.0,   0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -6.21,  6.21,   0.0,   0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -7.79,  0.0,    7.79,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -8.34,  0.0,    8.34,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -9.38,  0.0,    9.38,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                   -10.50,  0.0,   10.50,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                   -11.97, -4.05,   4.05, 11.97,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -12.70, -4.32,   4.32, 12.70,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -13.70, -4.63,   4.63, 13.70,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -14.67, -4.98,   4.98, 14.67,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -15.86, -7.91,   0.0,   7.91,  15.86,  0.0, 0.0, 0.0, 0.0;
                                   -16.95, 16.95,   0.0,   0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                   -18.37, -8.99,   0.0,   8.99,  18.37,  0.0, 0.0, 0.0, 0.0;
                                   -19.11, -9.76,   0.0,   9.76,  19.11,  0.0, 0.0, 0.0, 0.0;
                                   -20.15, -12.08, -4.05,  4.05,  12.08, 20.15,0.0, 0.0, 0.0}" comment=" x of holes "  />

              In AgSTAR, the misplaced ";" results in the second row starting with the 5th entry
              and extending to the next semi-colon.  The result is the following assignment 
              -->

            <var name="hx" value="{  0.0,   0.0,    0.0,   0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                     0.0,   0.0,    0.0,   0.0,    0.0, -5.17, 5.17,0.0, 0.0;
                                    -6.21,  6.21,   0.0,   0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -7.79,  0.0,    7.79,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -8.34,  0.0,    8.34,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                    -9.38,  0.0,    9.38,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                   -10.50,  0.0,   10.50,  0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                   -11.97, -4.05,   4.05, 11.97,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -12.70, -4.32,   4.32, 12.70,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -13.70, -4.63,   4.63, 13.70,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -14.67, -4.98,   4.98, 14.67,   0.0,   0.0, 0.0, 0.0, 0.0;
                                   -15.86, -7.91,   0.0,   7.91,  15.86,  0.0, 0.0, 0.0, 0.0;
                                   -16.95, 16.95,   0.0,   0.0,    0.0,   0.0, 0.0, 0.0, 0.0;
                                   -18.37, -8.99,   0.0,   8.99,  18.37,  0.0, 0.0, 0.0, 0.0;
                                   -19.11, -9.76,   0.0,   9.76,  19.11,  0.0, 0.0, 0.0, 0.0;
                                   -20.15, -12.08, -4.05,  4.05,  12.08, 20.15,0.0, 0.0, 0.0}" comment=" x of holes "  />

            <var name="offCrdIo" value="-0.9" comment=" cards, first row inner sector "  />
        </Fill>
        
        <Fill name="TROV" comment="holes and cards in row 2"  >
            <var name="sec" value="2" comment="  outer "  />
            <var name="nhp" value="{6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9}" comment=" number of holes in plane "  />

            <var name="hx" value="{-23.70, -15.77, -7.72, 7.72, 15.77, 23.70, 0.0,   0.0,     0.0;
                                   -24.15, -16.25, -8.10, 0.00,  8.10, 16.25, 24.15, 0.0,     0.0;
                                   -25.48, -17.47 ,-8.71, 0.00,  8.71, 17.47, 25.48, 0.0,     0.0;
                                   -25.48, -17.47, -8.71, 0.00,  8.71, 17.47, 25.48, 0.0,     0.0;
                                   -28.19, -19.43,-10.81, 0.00 ,10.81, 19.43, 28.19, 0.0,     0.0;
                                   -28.19, -19.43,-10.81, 0.00, 10.81, 19.43, 28.19, 0.0,     0.0;
                                   -30.24, -21.51,-13.54,-5.37,  5.37, 13.54, 21.51, 30.24,   0.0;
                                   -30.24, -21.51,-13.54,-5.37,  5.37, 13.54, 21.51, 30.24,   0.0;
                                   -32.23, -24.17,-16.09,-5.42,  5.42, 16.09, 24.17, 32.23,   0.0;
                                   -32.23, -24.17,-16.09,-5.42,  5.42, 16.09, 24.17, 32.23,   0.0;
                                   -34.30, -25.86,-16.14,-8.10,  8.10, 16.14, 25.86, 34.30,   0.0;
                                   -34.30, -25.86,-16.14,-8.10,  0.00,  8.10, 16.14, 25.86,  34.30;
                                   -36.16, -28.12,-16.14,-8.10,  0.00,  8.10, 16.14, 28.12,  36.16;
                                   -36.16, -28.12,-16.14,-8.10,  0.00,  8.10, 16.14, 28.12,  36.16;
                                   -38.37, -29.47,-20.76,-10.61, 0.00, 10.61, 20.76, 29.47,  38.37;
                                   -38.37, -29.47,-20.76,-10.61, 0.00, 10.61, 20.76, 29.47,  38.37}" comment="x of holes"  />
            <var name="offCrdIo" value="0.0" comment=" card no special case "  />
        </Fill>
        

        <Use struct="TPCG"  />


        tofcLENG = tpcg_Length-2*tpcg_WheelTHK-2*trdo_RdoVthk  ! gas plus endcaps 
        tpgvLeng = (tofcLeng-tpcg_MembTHK-2*tpcg_TpeaThk)/2 ! active gas 
        tocsIR = tpcg_SenGasOR;   tocsOR = tocsIR + tpcg_tocsDR 
        tokaIR = tocsOR;          tokaOR = tokaIR + tpcg_tokaDR 
        tonxIR = tokaOR;          tonxOR = tonxIR + tpcg_tonxDR 
        toadIR = tonxOR;          toadOR = toadIR + tpcg_toadDR 
        toigIR = toadOR;          toigOR = toigIR + tpcg_toigDR 
        toalIR = toigOR;          toalOR = toalIR + tpcg_toalDR 
        tohaIR = toalOR;          tohaOR = tohaIR + tpcg_tohaDR 
        tifcIR = tpcg_Rmin      ! inner field cage inner radius 
        tiadIR = tifcIR;          tiadOR = tiadIR + tpcg_tiadDR 
        tinxIR = tiadOR;          tinxOR = tinxIR + tpcg_tinxDR 
        tikaIR = tinxOR;          tikaOR = tikaIR + tpcg_tikaDR 
        tialIR = tikaOR;          tialOR = tialIR + tpcg_tialDR       
        tofcIR = tocsIR;          tofcOR = tohaOR 
        tofsIR = tocsIR;          tofsOR = toadOR 
        tifcIR = tiadIR;          tifcOR = tialOR 
        tpgvIR = tifcOR         ! TPC gas inner radius 

        <Data variables="Mntcylht" values="30."  />
        <Data variables="Mntcylid" values="16."  />
        <Data variables="Mntcylod" values="20."  />
        del = tpcg_Rmax-tofcOR  
        <Print level="1" fmt="' TPCEgeo: maximum TPC Radius is ',F10.4,' clearance is ',F8.4"  >
            tofcOR,del 
        </Print>
        
        <If expr="del&lt;0"  >
            <Print level="0" fmt="' *** TPCEgeo ERROR : outer clearance negative ',F8.4"  >
                del
            </Print>
            
        </If>
        
        <Print level="1" fmt="' TPCEgeo: senset. gas inner radius',F10.4"  >
            tpgvIR
        </Print>
        
        <Call expr="TPCELASER" routine="AGSSTEP"  />
        <Create block="TPCE"  />
        <Placement block="TPCE" in="CAVE"  >
        </Placement>
        
        <Block name="TPCE" comment="is the TPC envelope"  >
            <Material name="Air"  />
            <Medium name="Standard"  />
            <Attribute for="TPCE" seen="0" colo="2"  />
            <Shape type="TUBE" rmax="tpcg_rmax" rmin="tpcg_rmin" dz="tpcg_length/2"  />
            tpgvz  = (tpcg_MembTHK + tpgvLeng)/2                 
            <Create block="TPGV"  />
            <Placement z="+tpgvz" block="TPGV"  >
                <Rotation thetaz="0" thetax="90" thetay="90" phiz="0" phiy="-15" phix="75"  />
            </Placement>
            
            <Placement z="-tpgvz" block="TPGV"  >
                <Rotation thetaz="180" thetax="90" thetay="90" phiz="0" phiy="195" phix="105"  />
            </Placement>
            
            <Create block="TIFC"  />
            <Placement block="TIFC"  >
            </Placement>
            
            <Create block="TOFC"  />
            <Placement block="TOFC"  >
            </Placement>
            
            <Create block="TPCM"  />
            <Placement block="TPCM"  >
            </Placement>
            
            tpeaZ  = (tofcLeng - tpcg_TpeaThk)/2                
            <Create block="TPEA"  />
            <Placement z="+tpeaZ" block="TPEA"  >
                <Rotation thetaz="0" thetax="90" thetay="90" phiz="0" phiy="-15" phix="75"  />
            </Placement>
            
            <Placement z="-tpeaZ" block="TPEA"  >
                <Rotation thetaz="180" thetax="90" thetay="90" phiz="0" phiy="195" phix="105"  />
            </Placement>
            
            tpcwz  = (tpcg_LENGth-2*trdo_RdoVthk-tpcg_WheelTHK)/2      
            <Create block="TPCW"  />
            <Placement z="+tpcwz" block="TPCW"  >
                <Rotation thetaz="0" thetax="90" thetay="90" phiz="0" phiy="-15" phix="75"  />
            </Placement>
            
            <Placement z="-tpcwz" block="TPCW"  >
                <Rotation thetaz="180" thetax="90" thetay="90" phiz="0" phiy="195" phix="105"  />
            </Placement>
            
            tprdoz  = (tpcg_LENGth-trdo_RdoVthk)/2      
            <Create block="TRDV"  />
            <Placement z="+tprdoz" block="TRDV"  >
                <Rotation thetaz="0" thetax="90" thetay="90" phiz="0" phiy="-15" phix="75"  />
            </Placement>
            
            <Placement z="-tprdoz" block="TRDV"  >
                <Rotation thetaz="180" thetax="90" thetay="90" phiz="0" phiy="195" phix="105"  />
            </Placement>
            
        </Block>
        
        <Block name="TPGV" comment="is the Gas Volume placed in TPC"  >

        <If expr="TPCG_gasCorr==1"  >
            density=0.9*0.001782+0.1*0.000667 
        <Else  >
                    T    = 298.06  
                    P    = 1016.59  
                    PATM = 0.001*P*750.062/760.  
                    rho  =(0.9*0.001782+0.1*0.000717)  

                    density=rho*(273.15/T)*PATM 
         </Else>               
         </If>
            

         <Mixture name="p10" dens="density"  >
             <Component name="Ar" a="40" z="18" w="9"  />
             <Component name="C" a="12" z="6" w="1"  />
             <Component name="H" a="1" z="1" w="4"  />
         </Mixture>
            
         <Shape type="TUBE" rmax="tpcg_SenGasOR" rmin="tpgvIR" dz="tpgvLeng/2"  />
         <Create block="TPSS"  />

        </Block>

       
        <Block name="TPSS" comment="is a division of gas volume corresponding to a supersectors"  >

            <Attribute for="TPSS" seen="0"  />
            <Shape type="DIVISION" ndiv="12" iaxis="2"  />

            <Do var="i_sec" from="1" to="2"  >
                <Use struct="TPRS" select="sec" value="i_sec "  />

                <Do var="i_row" from="1" to="nint(tprs_nRow)"  >
                    <If expr="nint(tprs_super)==3|i_row==1"  >

                        <Create block="TPAD"  />
                        <Placement 
                            block = "TPAD" 
                            x     = "tprs_Rpads(i_row)-tprs_width" 
                            dx    = "tprs_width/2" 
                            dy    = "tprs_npads(i_row)*tprs_pitch/2" 
                         />

                    </If>
                    
                    <If expr="nint(tprs_super)&gt;0"  >

                        <Create block="TPAD"  />
                        <Placement 
                            block = "TPAD" 
                            x     = "tprs_Rpads(i_row)" 
                            dx    = "tprs_width/2" 
                            dy    = "tprs_npads(i_row)*tprs_pitch/2"  
                         />
                        
                    </If>
                    
                    <If expr="nint(tprs_super)==3|i_row==nint(tprs_nRow)"  >

                        <Create block="TPAD"  />
                        <Placement 
                            block = "TPAD" 
                            x     = "tprs_Rpads(i_row)+tprs_width" 
                            dx    = "tprs_width/2" 
                            dy    = "tprs_npads(i_row)*tprs_pitch/2"  
                        />
                        
                    </If>
                    
                </Do>
                
            </Do>
            
        </Block>
        
        <Block name="TPAD" comment="is a real padrow with dimensions defined at positioning time"  >

            <Attribute for="TPAD" seen="0" colo="2" serial="1" cond="TPRS_width&lt;1.5"/>
            <Attribute for="TPAD" seen="0" colo="2" serial="2" cond="TPRS_width&gt;1.5"/>

            <Material name="p10"  />
            <Material stemax="2.5*tprs_width" isvol="1" name="sensitive_gas"  />
            <Shape type="BOX" dz="0" dx="0" dy="0"  />
            <Par name="STRA" value="1."  />

            <Instrument block="TPAD">

                 <!-- x,y,z coordinate.  S option always reats the hit as a single step -->
                 <Hit meas="z" bins="0.0005" opts="s" />
                 <Hit meas="y" bins="0.0005"          />
                 <Hit meas="z" bins="0.0005"          />

                 <!-- cosines of the angle in x, y, z with 10bit precision -->
                 <Hit meas="cx" nbits="10" />
                 <Hit meas="cy" nbits="10" />
                 <Hit meas="cz" nbits="10" />

                 <Hit meas="lptot" nbits="18" min="-3" max="2" />
                 <Hit meas="sleng" bins="0.1" min="0"  max="800" />
                 <Hit meas="tof"   nbits="16"  min="0"  max="1.0E-6" />
                 <Hit meas="lgam"  nbits="16"  min="-2" max="+2" />
                 <Hit meas="step"  nbits="11"  min="0"  max="10" />
                 <Hit meas="user"  nbits="21"  min="-0.01" max="0.01" />

            </Instrument>            


        </Block>
        
        <Block name="TIFC" comment="defines the Inner Field Cage placed in TPC"  >
            <Material name="Mylar"  />
            <Attribute for="TIFC" seen="1" colo="4"  />
            <Shape type="TUBE" rmax="tifcOR" rmin="tiadIR" dz="tofcLeng/2"  />
            <Create block="TINX"  />
            <Placement block="TINX"  >
            </Placement>
            
        </Block>
        
        <Block name="TINX" comment="is the inner nomex structure"  >
            <Mixture name="Nomex" dens="0.048"  >
                <Component name="C" a="12" z="6" w="5"  />
                <Component name="H" a="1" z="1" w="8"  />
                <Component name="O" a="16" z="8" w="2"  />
            </Mixture>
            
            <Attribute for="TINX" seen="1" colo="5"  />
            <Shape type="TUBE" rmin="tinxIR"  />
            <Create block="TIKA"  />
            <Placement block="TIKA"  >
            </Placement>
            
        </Block>
        
        <Block name="TIKA" comment="is the kapton film of the inner field cage"  >
            <Material name="Mylar"  />
            <Attribute for="TIKA" seen="1" colo="6"  />
            <Shape type="TUBE" rmax="tikaOR" rmin="tikaIR"  />
            <Create block="TIAL"  />
            <Placement block="TIAL"  >
            </Placement>
            
        </Block>
        
        <Block name="TIAL" comment="is the inner Aluminum cylinder"  >
            <Material name="Aluminium"  />
            <Attribute for="TIAL" seen="1" colo="7"  />
            <Shape type="TUBE" rmax="tialOR" rmin="tialIR"  />
        </Block>
        
        <Block name="TOFC" comment="defines outer field cage - fill it with insulating gas already"  >
            <Material name="Nitrogen_gas"  />
            <Attribute for="TOFC" seen="1" colo="3"  />
            <Shape type="TUBE" rmax="tofcOR" rmin="tofcIR" dz="tofcLeng/2"  />
            <Create block="TOFS"  />
            <Placement block="TOFS"  >
            </Placement>
            
            <Create block="TOST"  />
            <Placement block="TOST"  >
            </Placement>
            
        </Block>
        
        <Block name="TOFS" comment="is the Outer Field Cage structure"  >
            <Material name="COPPER"  />
            <Attribute for="TOFS" seen="1" colo="4"  />
            <Shape type="TUBE" rmax="tofsOR"  />
            <Create block="TOKA"  />
            <Placement block="TOKA"  >
            </Placement>
            
        </Block>
        
        <Block name="TOKA" comment="is KAPTON layer"  >
            <Material name="mylar"  />
            <Attribute for="TOKA" seen="1" colo="3"  />
            <Shape type="TUBE" rmin="tokaIR"  />
            <Create block="TONX"  />
            <Placement block="TONX"  >
            </Placement>
            
        </Block>
        
        <Block name="TONX" comment="is Nomex support"  >
            <Material name="Nomex"  />
            <Attribute for="TONX" seen="1" colo="2"  />
            <Shape type="TUBE" rmin="tonxIR"  />
            <Create block="TOAD"  />
            <Placement block="TOAD"  >
            </Placement>
            
        </Block>
        
        <Block name="TOAD" comment="is Adhesive layer"  >
            <Material name="mylar"  />
            <Attribute for="TOAD" seen="1" colo="7"  />
            <Shape type="TUBE" rmin="toadIR"  />
        </Block>
        
        <Block name="TOST" comment="is the Outer Field Cage Support"  >
            <Material name="Aluminium"  />
            <Attribute for="TOST" seen="1" colo="2"  />
            <Shape type="TUBE" rmin="toalIR"  />
            <Create block="TOHA"  />
            <Placement block="TOHA"  >
            </Placement>
            
        </Block>
        
        <Block name="TOHA" comment="is Honeycomb/Adhesive mixture"  >
            <Mixture name="Al_honeycomb" dens="0.282"  >
                <Component name="Al" a="27" z="13" w="0.0105"  />
                <Component name="N" a="14" z="7" w="0.7395"  />
                <Component name="Adhesive" a="9" z="4.5" w="0.2500"  />
            </Mixture>
            
            <Attribute for="TOHA" seen="1" colo="7"  />
            <Shape type="TUBE" rmin="tohaIR"  />
        </Block>
        

        <Block name="TPCM" comment="is the Central Membrane placed in TPC"  >
            <Material name="Mylar"  />
            <Attribute for="TPCM" seen="1" colo="4"  />
            <Shape type="TUBE" rmax="tpcg_SenGasOR" rmin="tpgvIR" dz="tpcg_MembTHK/2"  />
        </Block>
        
        <Block name="TPEA" comment="is one endcap placed in TPC"  >
            <Material name="p10"  />
            <Attribute for="TPEA" seen="0"  />
            <Shape type="TUBE" rmax="tpcg_SenGasOR" rmin="tpgvIR" dz="tpcg_TpeaThk/2"  />
            <Create block="TESS"  />
        </Block>
        
        <Block name="TESS" comment="is a division of endcap volume corresponding to one supersector"  >
            <Attribute for="TESS" seen="1"  />
            <Shape type="DIVISION" ndiv="12" iaxis="2"  />

            <Do var="i_sec" from="1" to="2"  >
                <Use struct="TECW" select="sec" value="i_sec "  />
                <Use struct="TROV" select="sec" value="i_sec "  />
                <Create block="TSEC"  />
                <Placement x="tecw_Rcenter" z="(tpcg_TpeaThk-tecw_AsDepth-tecw_PpDepth-tecw_GgDepth)/2" block="TSEC"  >
                    <Rotation ort="YZX"  />
                </Placement>
                
            </Do>
            

        </Block>
        
        <Block name="TSEC" comment="is a supersector containing Al sector, PCB and MWC volume"  >
            <Material name="Aluminium"  />
            <Shape type="TRD1" dz="tecw_Height/2" dx2="tecw_ouwidth/2" dx1="tecw_inwidth/2" dy="(tecw_PpDepth+tecw_AsDepth+tecw_GgDepth)/2"  />

            <Create block="TMWC"  />
            <Placement y="-(tecw_PpDepth+tecw_AsDepth)/2" block="TMWC"  >
            </Placement>
            
            <Create block="TIAG"  />
            dx_dz = (tecw_ouwidth - tecw_inwidth)/(2*tecw_Height ) 
            dxb = tecw_boundary * sqrt( 1. + dx_dz*dx_dz ) 

            <Do var="i" from="1" to="nint(tecw_n)"  >

                <Placement block="TIAG"    z="-tecw_Height/2+tecw_z(i)"  y="+tecw_ppdepth/2+tecw_GgDepth/2"
                           konly="'MANY'" 
                           dx1="tecw_inwidth/2-dxb+(tecw_z(i)-tecw_dz(i)/2)*dx_dz"
                           dx2="tecw_inwidth/2-dxb+(tecw_z(i)+tecw_dz(i)/2)*dx_dz"
                           dy ="tecw_asdepth/2"
                           dz ="tecw_dz(i)/2"                        
                           />
                
            </Do>
            

            <Create block="TCEX"  />
            <Create block="TAEC"  />
            <Create block="THOL"  />
            <Create block="THRA"  />
            <Create block="THLA"  />

            <Do var="i_nhp" from="1" to="16"  >
                hpla = -tecw_Height/2+tecw_z(1)-tecw_dz(1)/2+trov_offCrdIo !first pl 
                zvalue = Hpla+4.0*(i_nhp-1) 

                <If expr="trov_Nhp(i_nhp)&gt;0"  >
                    <Do var="j_nho" from="1" to="trov_Nhp(i_nhp)"  >

                        <Placement block="TCEX" y="+tecw_PpDepth/2+tecw_GgDepth/2" x="trov_Hx(j_nho,i_nhp)" z="zvalue+tecw_cardoff" />                       
                        <Placement block="TAEC" y="+tecw_PpDepth/2+tecw_GgDepth/2" x="trov_Hx(j_nho,i_nhp)" z="zvalue+tecw_cooloff" />
                        <Placement block="THOL" y="+tecw_GgDepth/2-tecw_AsDepth/2" x="trov_Hx(j_nho,i_nhp)" z="zvalue+tecw_cardoff" />
                        <Placement block="THRA" y="+tecw_GgDepth/2-tecw_AsDepth/2" x="trov_Hx(j_nho,i_nhp)+tecw_slotw/2" z="zvalue+tecw_cardoff">
                            <Rotation ort="ZXY"  />
                        </Placement>
                        <Placement block="THLA" y="+tecw_GgDepth/2-tecw_AsDepth/2" x="trov_Hx(j_nho,i_nhp)-tecw_slotw/2" z="zvalue+tecw_cardoff">
                            <Rotation ort="ZXY"  />
                        </Placement>
                        
                    </Do>
                    
                </If>
                
            </Do>
            

            <Create block="TOAE"  />
            <Do var="i" from="1" to="nint(tecw_nex)"  >
                <Placement block="TOAE" dy="tecw_asdepth/2" dz="tecw_DZex(i)/2" dx="tecw_DXex(i)/2" y="+tecw_ppdepth/2+tecw_GgDepth/2" x="tecw_Xex(i)" z="tecw_Zex(i)-tecw_Height/2"/>                
            </Do>
            

        </Block>
        
        <Block name="TMWC" comment="is a wire chamber volume with both gated and sensitive volumes"  >
            <Material name="p10"  />
            <Attribute for="TMWC" seen="1" colo="3"  />
            <Shape type="TRD1" dz="tecw_Height/2" dx2="tecw_ouwidth/2" dx1="tecw_inwidth/2" dy="tecw_GgDepth/2"  />
            <Check expr="  tpcg_MWCread&gt;0 "  />
            <Create block="TMEA"  />
            <Placement y="+(tecw_GgDepth-tecw_MWCdepth)/2" z="tecw_MwcCent" block="TMEA"  >
            </Placement>
            

        </Block>
        
        <Block name="TMEA" comment="is a double sensitive layer around gating grid"  >
            <Material name="p10"  />
            <Material stemax="5" isvol="1" name="sensitive_gas"  />
            <Attribute for="TMEA" seen="1" colo="4"  />
            <Shape type="TRD1" dz="tecw_MWChei/2" dx2="tecw_MWCout/2" dx1="tecw_MWCinn/2" dy="tecw_MWCdepth/2"  />
            <Create block="TMSE"  />
            <Par name="STRA" value="1."  />
        </Block>
        
        <Block name="TMSE" comment="is a single sensitive volume"  >

            <Shape type="DIVISION" ndiv="tecw_MwcNwir" iaxis="3"  />

            <If expr="TPCG_MWCread==1"  >
            <Instrument block="TMSE">

                 <Hit meas="z" bins="0.01" opts="s"                                  />
                 <Hit meas="y" bins="0.01"                                           />
                 <Hit meas="z" bins="0.01" min="-tecw_MWCout/2" max="+tecw_MWCout/2" />

                 <Hit meas="cx" nbits="10" />
                 <Hit meas="cy" nbits="10" />
                 <Hit meas="cz" nbits="10" />

                 <Hit meas="sleng" bins="0.1" min="0"  max="800" />
                 <Hit meas="step"  bins="0.1" />

                 <Hit meas="tof"   nbits="16"  min="0"  max="1.0E-6" />
                 <Hit meas="ptot"  nbits="16"  min="0"  max="100"    />
                 
                 <Hit meas="lgam"  nbits="16"  min="-2" max="+2"     />
                 <Hit meas="elos"  nbits="16"  min="0." max="0.01"   />

            </Instrument>

            <Else  >
            <Instrument block="TMSE">

                 <Hit meas="z" bins="0.01" opts="s" />
                 <Hit meas="y" bins="0.01"          />
                 <Hit meas="z" bins="0.01"          />

                 <Hit meas="cx" nbits="10" />
                 <Hit meas="cy" nbits="10" />
                 <Hit meas="cz" nbits="10" />

                 <Hit meas="sleng" bins="0.1" min="0"  max="800" />
                 <Hit meas="step"  bins="0.1" />

                 <Hit meas="tof"   nbits="16"  min="0"  max="1.0E-6" />
                 <Hit meas="ptot"  nbits="16"  min="0"  max="100"    />
                 
                 <Hit meas="lgam"  nbits="16"  min="-2" max="+2"     />
                 <Hit meas="elos"  nbits="16"  min="0." max="0.01"   />

            </Instrument>



            </Else>                
            </If>
            
        </Block>
        
        <Block name="THOL" comment="is part of a hole for PC boards"  >
            <Material name="Air"  />
            <Shape type="BOX" dz="tecw_slotrad" dx="tecw_slotw/2" dy="tecw_PpDepth/2"  />
        </Block>
        
        <Block name="THRA" comment="is part of a hole for PC boards"  >
            <Material name="Air"  />
            <Shape type="TUBS" rmin="0.0" rmax="tecw_slotrad" dz="tecw_PpDepth/2" phi2="180.0" phi1="0.0"  />
        </Block>
        
        <Block name="THLA" comment="is part of a hole for PC boards"  >
            <Material name="Air"  />
            <Shape type="TUBS" rmin="0.0" rmax="tecw_slotrad" dz="tecw_PpDepth/2" phi2="360.0" phi1="180.0"  />
        </Block>
        

        <Block name="TIAG" comment="is an air gap in inner sector aluminum structure"  >
            <Material name="Air"  />
            <Shape type="TRD1" dz="0" dx2="0" dx1="0" dy="0"  />
        </Block>
        
        <Block name="TOAE" comment="is extra aluminum supports in the air opennings"  >
            <Material name="Aluminium"  />
            <Shape type="BOX" dz="0" dx="0" dy="0"  />
        </Block>
        
        <Block name="TCEX" comment="is part of the G10 for the PC boards"  >

         <Mixture name="G10" dens="1.7"  >
            <Component name="Si" a="28.08" z="14" w="0.6*1*28./60."  />
            <Component name="O" a="16" z="8" w="0.6*2*16./60. + 0.4*4*16./174."  />
            <Component name="C" a="12" z="6" w="0.4*8*12./174."  />
            <Component name="H" a="1"  z="1" w="0.4*14*1./174."  />
        </Mixture>
           
            <Material name="G10"  />
            <Shape type="BOX" dz="tecw_cardth/2" dx="tecw_cardw/2" dy="tecw_AsDepth/2"  />
        </Block>
        
        <Block name="TAEC" comment="is part of the heat shield for the PC boards"  >
            <Material name="Aluminium"  />
            <Shape type="BOX" dz="tecw_coolth/2" dx="tecw_coolw/2" dy="tecw_AsDepth/2"  />
        </Block>
        
        <Block name="TPCW" comment="is the TPC supporting endcap Wheel"  >
            <Material name="Aluminium"  />
            <Attribute for="TPEA" seen="1"  />
            <Shape type="TUBE" rmax="tpcg_WheelOR" rmin="tpcg_WheelIR" dz="tpcg_WheelTHK/2"  />
            <Create block="TWSS"  />
        </Block>
        
        <Block name="TWSS" comment="is a division of wheel corresponding to supersectors"  >
            <Attribute for="TWSS" seen="0"  />
            <Shape type="DIVISION" ndiv="12" iaxis="2"  />
            <Do var="i_sec" from="1" to="2"  >
                <Use struct="TECW" select="sec" value="i_sec "  />
                <Use struct="TROV" select="sec" value="i_sec "  />
                <Create block="TWGI"  />
                <Placement x="tecw_GapRad" block="TWGI"  >
                    <Rotation ort="YZX"  />
                </Placement>
                
            </Do>
            
        </Block>
        
        <Block name="TWGI" comment="is the Inner air gap in Wheel"  >
            <Material name="Air"  />
            <Attribute for="TWGI" seen="1"  />

            <Shape type="TRD1" dz="tecw_GapHeit/2" dx2="tecw_GapWidO/2" dx1="tecw_GapWidI/2" dy="tpcg_WheelTHK/2"  />

            dx_dz=(tecw_GapWidO/2-tecw_GapWidI/2)/tecw_GapHeit 
            xlip=tecw_Whlipwid*sqrt(1+dx_dz*dx_dz) 
            xbottom =tecw_GapWidI/2+xlip-dx_dz*(tecw_Whlipwid-tecw_GapShft) 

            <Create block="TWGC"  />
            <Placement dx2="tecw_GapWidO/2+xlip+dx_dz*tecw_Whlipwid" dx1="xbottom" dz="tecw_GapHeit/2+tecw_Whlipwid-tecw_GapShft" dy="(tpcg_WheelTHK-tecw_Whlipthk)/2" y="tecw_Whlipthk/2" z="tecw_GapShft" block="TWGC"  >
            </Placement>
            
            <Create block="TWGB"  />
            <Placement y="tecw_Whlipthk/2" x="0" z="(tecw_GapHeit/2+tecw_Whlipwid/2)" block="TWGB"  >
                <Rotation alphay="90"  />
            </Placement>
            
            <If expr="tecw_Whblkin==1"  >
                <Placement y="tecw_Whlipthk/2" x="0" z="-(tecw_GapHeit/2+tecw_Whlipwid/2)" block="TWGB"  >
                    <Rotation alphay="90"  />
                </Placement>
                
            </If>
            
            <Placement y="tecw_Whlipthk/2" x="tecw_GapWidI/2+xlip/2+dx_dz*(tecw_Whblkpos+tecw_GapHeit/2)" z="tecw_Whblkpos" block="TWGB"  >
                <Rotation alphay="15"  />
            </Placement>
            
            <Placement y="tecw_Whlipthk/2" x="tecw_GapWidI/2+xlip/2+dx_dz*(-tecw_Whblkpos+tecw_GapHeit/2)" z="-tecw_Whblkpos" block="TWGB"  >
                <Rotation alphay="15"  />
            </Placement>
            
            <Placement y="tecw_Whlipthk/2" x="-tecw_GapWidI/2-xlip/2-dx_dz*(tecw_Whblkpos+tecw_GapHeit/2)" z="tecw_Whblkpos" block="TWGB"  >
                <Rotation alphay="-15"  />
            </Placement>
            
            <Placement y="tecw_Whlipthk/2" x="-tecw_GapWidI/2-xlip/2-dx_dz*(-tecw_Whblkpos+tecw_GapHeit/2)" z="-tecw_Whblkpos" block="TWGB"  >
                <Rotation alphay="-15"  />
            </Placement>
            
            radoff = tecw_Rcenter-tecw_GapRad-tecw_Height/2+tecw_GapHeit/2 

            <Do var="i_nhp" from="1" to="16"  >
                <If expr="trov_Nhp(i_nhp)&gt;0"  >
                    hpla = -tecw_GapHeit/2+radoff+tecw_z(1)-tecw_dz(1)/2+trov_offCrdIo !first pl 
                    zvalue = Hpla+4.0*(i_nhp-1) 
                    pipeoff=tecw_pipeht/2+tecw_coolth+tecw_cardth/2       
                    xtemp=tecw_GapWidI/2 
                    ztemp=zvalue+tecw_cardoff-pipeoff 
                    <Create block="TPIP"  />

                    <Placement block="TPIP"  y="-tpcg_WheelTHK/2+tecw_pipethk/2" z="ztemp" 
                                             dx2="xtemp+dx_dz*(ztemp+tecw_GapHeit/2+tecw_pipeht/2)" 
                                             dx1="xtemp+dx_dz*(ztemp+tecw_GapHeit/2-tecw_pipeht/2)" 
                                             dz="tecw_pipeht/2" dy="tecw_pipethk/2" 
                     />
                    
                </If>
                
            </Do>
            
            <Create block="TMAN"  />
            <Placement block="TMAN" 
                       dz="(1.+dx_dz*dx_dz)*(tecw_GapHeit/2-tecw_maniwid)" 
                       dx="tecw_maniwid/2" dy="tecw_manithk/2"  
                       y="-tpcg_WheelTHK/2+tecw_pipethk+tecw_manithk/2" 
                       x="tecw_GapWidI/2.+dx_dz*(tecw_GapHeit/2)-(1+dx_dz*dx_dz)*tecw_maniwid/2" 
                       z="0.0"  >
                <Rotation alphay="15"  />
            </Placement>            
            <Placement block="TMAN" 
                       dz="(1.+dx_dz*dx_dz)*(tecw_GapHeit/2-tecw_maniwid)" 
                       dx="tecw_maniwid/2" dy="tecw_manithk/2" 
                       y="-tpcg_WheelTHK/2+tecw_pipethk+tecw_manithk/2" 
                       x="-tecw_GapWidI/2.-dx_dz*(tecw_GapHeit/2)+(1+dx_dz*dx_dz)*tecw_maniwid/2" 
                       z="0.0">                
                <Rotation alphay="-15"  />
            </Placement>
            
            <Create block="TCRX"  />
            <Create block="TALC"  />
            <Do var="i_nhp" from="1" to="16"  >
                <If expr="trov_Nhp(i_nhp)&gt;0"  >
                    hpla = -tecw_GapHeit/2+radoff+tecw_z(1)-tecw_dz(1)/2+trov_offCrdIo !first pl 
                    zvalue = Hpla+4.0*(i_nhp-1) 
                    <Do var="j_nho" from="1" to="trov_Nhp(i_nhp)"  >
                        <Placement x="trov_Hx(j_nho,i_nhp)" z="zvalue+tecw_cardoff" block="TCRX"  >
                        </Placement>
                        
                        <Placement x="trov_Hx(j_nho,i_nhp)" z="zvalue+tecw_cooloff" block="TALC"  >
                        </Placement>
                        
                    </Do>
                    
                </If>
                
            </Do>
            
        </Block>
        
        <Block name="TWGC" comment="is the larger Inner air gap in Wheel"  >
            <Material name="Air"  />
            <Attribute for="TWGC" seen="1" colo="7"  />
            <Shape type="TRD1" dz="0" dx2="0" dx1="0" dy="0"  />
        </Block>
        
        <Block name="TWGB" comment="is added alum blocksin Wheel"  >
            <Material name="Aluminium"  />
            <Attribute for="TWGB" seen="1"  />
            <Shape type="BOX" dz="tecw_Whblklen/2" dx="tecw_Whlipwid/2" dy="(tpcg_WheelTHK-tecw_Whlipthk)/2"  />
        </Block>
        
        <Block name="TMAN" comment="is aluminum water manifold"  >
            <Material name="Aluminium"  />
            <Attribute for="TWGB" seen="1"  />
            <Shape type="BOX" dz="0" dx="0" dy="0"  />
        </Block>
        

        <Block name="TPIP" comment="is a water pipe there are lots per sect"  >
            <Material name="Aluminium"  />
            <Attribute for="TPIP" seen="1" colo="4"  />
            <Shape type="TRD1" dz="0" dx2="0" dx1="0" dy="0"  />
        </Block>
        

        <Block name="TCRX" comment="is part of the G10 for the PC boards"  >
            <Material name="G10"  />
            <Attribute for="TCRX" seen="1" colo="4"  />
            <Shape type="BOX" dz="tecw_cardth/2" dx="tecw_cardw/2" dy="tpcg_WheelThk/2"  />
        </Block>
        
        <Block name="TALC" comment="is part of the heat shield for the PC boards"  >
            <Material name="Aluminium"  />
            <Attribute for="TALC" seen="1" colo="6"  />
            <Shape type="BOX" dz="tecw_coolth/2" dx="tecw_coolw/2" dy="tpcg_WheelThk/2"  />
        </Block>
        

        <Block name="TRDV" comment="is the RDO board volume"  >
            <Material name="Air"  />
            <Attribute for="TRDV" seen="1" colo="2"  />
            <Shape type="TUBE" rmax="tpcg_WheelOR" rmin="tpcg_WheelIR" dz="trdo_RdoVthk/2"  />
            <Create block="TRDS"  />
        </Block>
        


        <Block name="TRDS" comment="is a division of rdo board volume corresponding to one supersector"  >
            <Attribute for="TRDS" seen="1"  />
            <Shape type="DIVISION" ndiv="12" iaxis="2"  />
            <Use struct="TRDO"  />
            <Do var="kk" from="1" to="trdo_NRdobrd"  >
                <Create block="TRDC"  />
                <Placement dz="trdo_Rdothk/2" dx="(trdo_Rdoht(kk)*tecw_tan15)-tecw_clearance" dy="trdo_Rdolen/2" x="trdo_Rdoht(kk)" block="TRDC"  >
                    <Rotation ort="YZX"  />
                </Placement>
                
            </Do>
            
        </Block>
        
        <Block name="TRDC" comment="is an RDO Card"  >
            <Mixture name="G10" dens="1.7"  >
                <Component name="Si" a="28.08" z="14" w="0.6*1*28./60."  />
                <Component name="O" a="16" z="8" w="0.6*2*16./60."  />
                <Component name="C" a="12" z="6" w="0.4*8*12./174."  />
                <Component name="H" a="1" z="1" w="0.4*14*1./174."  />
                <Component name="O" a="16" z="8" w="0.4*4*16./174."  />
            </Mixture>
            
            <Material name="G10"  />
            <Shape type="BOX" dz="0" dx="0" dy="0"  />

        </Block>
        

    </Module>
    






























</Document>

